---
output:
  html_document: default
  word_document: default
---
```{r include=FALSE}
#Open necessary packages 
library("haven")
library("tidyLPA")
library("dplyr")
library ("tidyr")
library("lubridate")
library("reshape2")
#install.packages("mice")
library("mice")
library("janitor")
library("crimCV")
library("ggplot2")
library("kableExtra")
#install.packages("magrittr")
library("stringr")
library("magrittr")
#install.packages("devtools")
library("devtools")
#install.packages("gbm")
#av <- available.packages(filters=list())
#av[av[, "Package"] == "gbmt", ] 
library("gbm")
```

```{r include=FALSE}
#Read LSAc SPSS files in R (time-use diaries and general survey data)
tudb10 <- read_sav("Z:/LSAC dataset/General Release/TUDs/SPSS/tudb10.sav")
tudb12 <- read_sav("Z:/LSAC dataset/General Release/TUDs/SPSS/tudb12.sav")
tudb14 <- read_sav("Z:/LSAC dataset/General Release/TUDs/SPSS/tudb14.sav")
lsacgrb10 <- read_sav("Z:/LSAC dataset/General Release/Survey data/SPSS/lsacgrb10.sav")
```

```{r include=FALSE}
#Select relevant columns for each TUD; alarm3 was not selected because this information is not relevant for our analyis; alarm4 will be used; select relevant columns for participant data
relevantcols10 <- tudb10 %>% 
  select(hicid, loop, awake, bed, sleep, stime, mainact, actlab, secact1, secact2, secact3, day, alarm1, alarm2, alarm4, school, nosch)
relevantcols12 <- tudb12 %>% 
  select(hicid, loop, awake, bed, sleep, stime, mainact, actlab, secact1, secact2, secact3, day, alarm1, alarm2, alarm4, school, nosch)
relevantcols14 <- tudb14 %>% 
  select(hicid, loop, awake, bed, sleep, stime, mainact, secact1, secact2, secact3, day, alarm1, alarm2, alarm4, school, nosch)
relevant_lsacgrb10 <- lsacgrb10 %>% 
  select(hicid, ff03m1, zf02m1, zf12m1, fsep2, fremote) %>% 
  rename("Age" = ff03m1, "Sex" = zf02m1, "Indigenous" = zf12m1, "SEP" = fsep2, "Remoteness" = fremote)


```


```{r include=FALSE}
#Code from 19JULY2020
#Calculate time spent in each behaviour for TUD10
d10 <- relevantcols10 %>% 
#Group activities by participant 
  group_by(hicid) %>% 
#Assign start time of following actives as "end time", make numeric so later on times that occur after midnight can be subtracted without becoming negative
  mutate(end_time_num = as.numeric(lead(stime))) %>%
#Make start and sleep times as numeric to avoid negative midnight problem 
  mutate(start_time_num = as.numeric(stime)) %>%
  mutate(sleep_time_num = as.numeric(sleep)) %>% 
  mutate(awake_time_num = as.numeric(awake))
#Take care of alarm1 by deleting these participants; alarm1 refers to start times that were recorded incorrectly or out of order, this can potentially screw up the data and we do not want to make assumptions about the participants' activities, so we will not include them in our analysis 
d10[d10$alarm1 == 1,]
d10 <- d10[!(d10$alarm1==1),]
#Take care of alarm2: this is when activities were recorded after bedtime, but before wake up time. We will delete these activities that occur after sleep time because their duration cannot be recorded. However, activities recorded after bedtime will remain because their duration can be calculated. 
d10[d10$alarm2 == 1,]
d10 <- d10[!((d10$alarm2 == 1) & (d10$stime >= d10$sleep)),]
#Assign last activities of the day to be NA since they don't have a time to be subtracted from 
before_sleep <- is.na(d10$end_time_num)
#Assign sleep time to be end time for last activities of the day
d10$end_time_num[before_sleep] <- (d10$sleep_time_num[before_sleep])
#Add "1 day" to end times that occur after midnight 
next_day_finish <- (d10$end_time_num < d10$start_time_num) & !is.na(d10$end_time_num)
 #table(next_day_finish)
d10$end_time_num[next_day_finish] <- (d10$end_time_num[next_day_finish] + 86400)
#Subtract start time from end time to get the total time spent in each activity 
d10$total_time_num <- d10$end_time_num - d10$start_time_num
#hist(d$total_time_num)
#Convert total time from seconds to minutes 
d10$total_minutes <- d10$total_time_num %/% 60
#Get rid of NAs for sleep time because nighttime sleep cannot be calculated, since less than 5% (6/3460) participants have missing sleep data it is OK to delete them without biasing the results 
d10[!is.na(d10$sleep_time_num),] -> d10_cleaned
d10_cleaned

```

```{r include=FALSE}
#Assign TUD activity codes to domain-specific variables for B-cohort at age 10
unstr_lt_pa <- c(427, 428, 430, 454, 463, 464, 465, 466, 491, 450, 451)
wrk_hh_pa <- c(1,11,31,41,51, 61, 71, 82, 83, 84, 91, 201, 221,231,301, 311, 321, 331, 341, 342, 344, 351, 361, 362, 363, 364, 365, 366, 367, 368, 371, 381)
active_trans <- c(901, 911)
str_lt_mvpa <- c(401, 402, 403, 404, 405, 406, 407, 408, 411, 412, 413, 414, 415, 416, 417, 418, 440)
unstr_lt_mvpa <- c(421, 422, 423, 424, 425, 426)
education_sb <- c(21, 81, 501, 521, 531, 541, 581, 601, 701)
lt_sb <- c(281, 312, 981, 481, 462, 101, 511, 542, 543, 544, 545, 548, 551, 552, 555, 561, 591, 452, 453, 455, 456, 457, 458, 471, 472, 473)
passive_trans <- c(921, 931, 941)
recreational_screentime <- c(461, 611, 612, 621, 631, 641, 651, 661, 671, 681, 691, 841, 851)
selfcare_sb <- c(211, 241, 251, 261, 271)
social_sb <- c(802, 811, 821, 831, 861, 871, 881)
daytime_naps <- 571
uncodeable_activity <- c(971, 991, 998)
no_secact <- -9

#Add columns for domain-specific main and all secondary activities 
d10_cleaned %>% 
  mutate(domain_main_activity = case_when(
    mainact %in% unstr_lt_pa ~ "Unstructured Leisure Time Light Physical Activity",
    mainact %in% wrk_hh_pa ~ "Work and Household Light Physical Activity",
    mainact %in% active_trans ~ "Active Transportation",
    mainact %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    mainact %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    mainact %in% education_sb ~ "Education Based Sedentary Behaviour",
    mainact %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    mainact %in% passive_trans ~ "Passive Transportation",
    mainact %in% recreational_screentime ~ "Recreational Screen Time",
    mainact %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    mainact %in% social_sb ~ "Social Sedentary Behaviour",
    mainact %in% daytime_naps ~ "Daytime Naps",
    mainact %in% uncodeable_activity ~ "Uncodeable Activity")) %>% 
  mutate(domain_secondary1_activity = case_when(
    secact1 %in% unstr_lt_pa ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    secact1 %in% wrk_hh_pa ~ "Work and Household Light-Intensity Physical Activity",
    secact1 %in% active_trans ~ "Active Transportation",
    secact1 %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact1 %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact1 %in% education_sb ~ "Education-Based Sedentary Behaviour",
    secact1 %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    secact1 %in% passive_trans ~ "Passive Transportation",
    secact1 %in% recreational_screentime ~ "Recreational Screen Time",
    secact1 %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    secact1 %in% social_sb ~ "Social-Based Sedentary Behaviour",
    secact1 %in% daytime_naps ~ "Daytime Naps",
    secact1 %in% uncodeable_activity ~ "Uncodeable Activity",
    secact1 %in% no_secact ~ "None"
  )) %>% 
  mutate(domain_secondary2_activity = case_when(
    secact2 %in% unstr_lt_pa ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    secact2 %in% wrk_hh_pa ~ "Work and Household Light-Intensity Physical Activity",
    secact2 %in% active_trans ~ "Active Transportation",
    secact2 %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact2 %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact2 %in% education_sb ~ "Education-Based Sedentary Behaviour",
    secact2 %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    secact2 %in% passive_trans ~ "Passive Transportation",
    secact2 %in% recreational_screentime ~ "Recreational Screen Time",
    secact2 %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    secact2 %in% social_sb ~ "Social-Based Sedentary Behaviour",
    secact2 %in% daytime_naps ~ "Daytime Naps",
    secact2 %in% uncodeable_activity ~ "Uncodeable Activity",
    secact2 %in% no_secact ~ "None"
  )) %>% 
  mutate(domain_secondary3_activity = case_when(
    secact3 %in% unstr_lt_pa ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    secact3 %in% wrk_hh_pa ~ "Work and Household Light-Intensity Physical Activity",
    secact3 %in% active_trans ~ "Active Transportation",
    secact3 %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact3 %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact3 %in% education_sb ~ "Education-Based Sedentary Behaviour",
    secact3 %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    secact3 %in% passive_trans ~ "Passive Transportation",
    secact3 %in% recreational_screentime ~ "Recreational Screen Time",
    secact3 %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    secact3 %in% social_sb ~ "Social-Based Sedentary Behaviour",
    secact3 %in% daytime_naps ~ "Daytime Naps",
    secact3 %in% uncodeable_activity ~ "Uncodeable Activity",
    secact3 %in% no_secact ~ "None"
  ))  %>% 
#Make decision rules based on main activities and secondary activities 
  mutate(domain_specific_movement_behaviour = case_when(
    (mainact %in% unstr_lt_pa & secact1 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% no_secact) ~ "Active Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% education_sb & secact1 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% recreational_screentime & secact1 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% selfcare_sb & secact1 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% daytime_naps & secact1 %in% no_secact & (total_minutes <= 240)) ~ "Daytime Naps",
    (mainact %in% daytime_naps & secact1 %in% no_secact & (total_minutes > 240)) ~ "Nighttime Sleep 1",
    (mainact %in% uncodeable_activity & secact1 %in% no_secact) ~ "Uncodeable Activity",
    (mainact %in% unstr_lt_pa & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% education_sb & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% recreational_screentime & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% selfcare_sb & secact1 %in% selfcare_sb & secact2 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% daytime_naps & secact1 %in% daytime_naps & secact2 %in% no_secact) ~ "Daytime Naps",
    (mainact %in% uncodeable_activity & secact1 %in% uncodeable_activity & secact2 %in% no_secact) ~ "Uncodeable Activity",
    (mainact %in% unstr_lt_pa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% wrk_hh_pa & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% wrk_hh_pa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% social_sb & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% social_sb & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% social_sb & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_pa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% education_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% selfcare_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% selfcare_sb & secact1 %in% social_sb & secact2 %in% education_sb & secact3 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% active_trans & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% lt_sb & secact2 %in% no_secact & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% uncodeable_activity & secact3 %in% uncodeable_activity) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% wrk_hh_pa) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% social_sb) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% str_lt_mvpa & secact3 %in% social_sb) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% unstr_lt_mvpa) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% active_trans) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% active_trans & secact3 %in% lt_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% unstr_lt_mvpa & secact3 %in% wrk_hh_pa) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% education_sb & secact2 %in% str_lt_mvpa & secact3 %in% lt_sb) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% education_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% social_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% education_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% uncodeable_activity & secact3 %in% recreational_screentime) ~ "Recreational Screen Time",
    (mainact %in% unstr_lt_mvpa & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% str_lt_mvpa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% str_lt_mvpa & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% uncodeable_activity & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% education_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% unstr_lt_mvpa) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Active Transportation",
    (mainact %in% social_sb & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% recreational_screentime & secact3 %in% recreational_screentime) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% active_trans) ~ "Active Transportation",
    (mainact %in% unstr_lt_pa & secact1 %in% active_trans & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% unstr_lt_mvpa) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% lt_sb & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% recreational_screentime) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% unstr_lt_pa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% recreational_screentime) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% recreational_screentime) ~ "Active Transportation",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% unstr_lt_pa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% daytime_naps & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Daytime Naps",
    (mainact %in% active_trans & secact1 %in% unstr_lt_pa & secact2 %in% no_secact & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% recreational_screentime & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% recreational_screentime) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% education_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% str_lt_mvpa & secact1 %in% unstr_lt_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% wrk_hh_pa & secact2 %in% recreational_screentime & secact3 %in% lt_sb) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% str_lt_mvpa & secact2 %in% recreational_screentime & secact3 %in% recreational_screentime) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% str_lt_mvpa & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% str_lt_mvpa & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% active_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% unstr_lt_pa & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% daytime_naps & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Daytime Naps",
    (mainact %in% passive_trans & secact1 %in% education_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% passive_trans & secact3 %in% lt_sb) ~ "Active Transportation",
    (mainact %in% passive_trans & secact1 %in% unstr_lt_pa & secact2 %in% active_trans & secact3 %in% social_sb) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% uncodeable_activity & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% social_sb & secact1 %in% str_lt_mvpa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% active_trans & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% education_sb & secact1 %in% social_sb & secact2 %in% active_trans & secact3 %in% passive_trans) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% wrk_hh_pa) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% str_lt_mvpa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% lt_sb) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% lt_sb) ~ "Active Transportation",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% recreational_screentime) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% unstr_lt_pa & secact3 %in% social_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% recreational_screentime & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% education_sb & secact1 %in% passive_trans & secact2 %in% lt_sb) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% selfcare_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% unstr_lt_mvpa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% unstr_lt_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_mvpa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% str_lt_mvpa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% daytime_naps & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% wrk_hh_pa) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% social_sb) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% daytime_naps & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% recreational_screentime & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% recreational_screentime & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% passive_trans & secact3 %in% recreational_screentime) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% passive_trans & secact2 %in% passive_trans & secact3 %in% recreational_screentime) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% str_lt_mvpa & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% passive_trans & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% wrk_hh_pa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & (secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% uncodeable_activity & (secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% passive_trans & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa |secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Passive Transportation",
    (mainact %in% active_trans & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb |secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa)) ~ "Active Transportation",
    (mainact %in% recreational_screentime & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa)) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & (secact1 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa) & (secact2 %in% social_sb | secact3 %in% social_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa) ) ~ "Recreational Screen Time",
    (mainact %in% str_lt_mvpa & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb |secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa)) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% unstr_lt_mvpa & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_pa | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% lt_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb |secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Leisure Time Sedentary Behaviour",
     (mainact %in% c(recreational_screentime, selfcare_sb, lt_sb, social_sb, wrk_hh_pa, education_sb, unstr_lt_pa, daytime_naps) & (secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Passive Transportation",
   (mainact %in% selfcare_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Self Care Sedentary Behaviour",
   (mainact %in% education_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Education-Based Sedentary Behaviour",
   (mainact %in% social_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb) & (secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & (secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & (secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Social-Based Sedentary Behaviour",
   (mainact %in% daytime_naps & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa))  ~ "Daytime Naps",
   (mainact %in% wrk_hh_pa & (secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Work and Household Light-Intensity Physical Activity",
   (mainact %in% unstr_lt_pa & (secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa  | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans) & !(secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
   (secact1 %in% lt_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact2 %in% active_trans | secact3 %in% active_trans | secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact2 %in% no_secact | secact3 %in% no_secact) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Leisure Time Sedentary Behaviour",
   (secact1 %in% selfcare_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Self Care Sedentary Behaviour",
   (secact1 %in% education_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Education-Based Sedentary Behaviour",
   (secact2 %in% c(education_sb, recreational_screentime, lt_sb, selfcare_sb, no_secact, wrk_hh_pa, unstr_lt_pa, social_sb) & (mainact %in% uncodeable_activity) & (secact1 %in% social_sb) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Social-Based Sedentary Behaviour",
   (secact2 %in% education_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact1 %in% uncodeable_activity) & !(secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Education-Based Sedentary Behaviour",
   (secact1 %in% social_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% lt_sb | secact3 %in% lt_sb |secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime) & !(secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Social-Based Sedentary Behaviour",
   (secact2 %in% recreational_screentime & (mainact %in% uncodeable_activity) & (secact1 %in% uncodeable_activity)) ~ "Recreational Screen Time",
   (secact2 %in% lt_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact1 %in% uncodeable_activity) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Leisure Time Sedentary Behaviour",
   (secact2 %in% selfcare_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Self Care Sedentary Behaviour",
   (secact3 %in% recreational_screentime & (mainact %in% uncodeable_activity) & (secact1 %in% uncodeable_activity) & (secact2 %in% uncodeable_activity)) ~ "Recreational Screen Time",
   (secact3 %in% lt_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact1 %in% uncodeable_activity | secact1 %in% daytime_naps) & (secact2 %in% wrk_hh_pa | secact2 %in% unstr_lt_pa | secact2 %in% uncodeable_activity | secact2 %in% daytime_naps | secact2 %in% social_sb) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Leisure Time Sedentary Behaviour",
   (secact1 %in% recreational_screentime & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact2 %in% daytime_naps | secact2 %in% lt_sb | secact2 %in% education_sb | secact2 %in% selfcare_sb | secact2 %in% social_sb) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Recreational Screen Time",
   (mainact %in% recreational_screentime & (secact1 %in% str_lt_mvpa) & (total_minutes > 60)) ~ "Recreational Screen Time",
   (mainact %in% recreational_screentime & (secact1 %in% str_lt_mvpa) & !(secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% education_sb | secact3 %in% education_sb) & total_minutes <= 60) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% recreational_screentime & (secact1 %in% unstr_lt_mvpa) & !(secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% education_sb | secact3 %in% education_sb) & total_minutes <= 60) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% recreational_screentime & (secact1 %in% unstr_lt_mvpa) & total_minutes > 60) ~ "Recreational Screen Time",
   (mainact %in% wrk_hh_pa & (secact1 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa) & (secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb)) ~ "Work and Household Light-Intensity Physical Activity",
   (mainact %in% unstr_lt_pa & (secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
   (mainact %in% unstr_lt_pa & (secact1 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa) & (secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
   (mainact %in% uncodeable_activity & secact1 %in% unstr_lt_pa & !(secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity"
    
  )) -> long_d10


#Check to make sure there are no missing decisions
#long_d10[is.na(long_d10$domain_specific_movement_behaviour),]

#Convert dataset from long to wide format 
long_d10 %>% 
  dcast(hicid + awake_time_num + sleep_time_num + day + school ~ c(domain_specific_movement_behaviour), value.var="total_minutes", fun.aggregate = sum) -> wide_d10

#Calculate Nighttime Sleep 
#Make variable for subjects who went to sleep before midnight
sleep_before_midnight <- !is.na(wide_d10$sleep_time_num) & (wide_d10$sleep_time_num > 43200)
#Make variable for subjects who went to sleep after midnight 
sleep_after_midnight <- !is.na(wide_d10$sleep_time_num) & (wide_d10$sleep_time_num <= 43200)

#For subjects who went to sleep before midnight, subtract their sleep time from 86400 
sleep_to_midnight_calculation <- (86400 - wide_d10$sleep_time_num[sleep_before_midnight])
#For the same subjects, add above calculation to their wake time to get their total sleep time 
total_sleep_before_midnight <- wide_d10$awake_time_num[sleep_before_midnight] + sleep_to_midnight_calculation
#Put calculation into dataset 
wide_d10$sleep_time_num[sleep_before_midnight] <- total_sleep_before_midnight
hist(total_sleep_before_midnight)
#For subjects who went to sleep after midnight, subtract sleep time from wake time 
total_sleep_after_midnight <- wide_d10$awake_time_num[sleep_after_midnight] - wide_d10$sleep_time_num[sleep_after_midnight]
#Put calculation into dataset 
wide_d10$sleep_time_num[sleep_after_midnight] <- total_sleep_after_midnight
hist(total_sleep_after_midnight)
#Convert sleep time into minutes 
nighttime_sleep <- wide_d10$sleep_time_num / 60
#Add nighttime sleep into dataset
wide_d10$"Nighttime Sleep 2" <- (nighttime_sleep)
#Add nighttime sleep 1 and nighttime sleep 2 
wide_d10$"Nighttime Sleep" <- wide_d10$`Nighttime Sleep 1` + wide_d10$`Nighttime Sleep 2`
wide_d10 <- wide_d10 %>%  select(-c(`Nighttime Sleep 1`, `Nighttime Sleep 2`))

#Add new columns for general movement behaviours
wide_d10$"Light-Intensity Physical Activity" <- wide_d10$`Active Transportation` + wide_d10$`Work and Household Light-Intensity Physical Activity` + wide_d10$`Unstructured Leisure Time Light-Intensity Physical Activity`
wide_d10$"Moderate- to Vigorous- Intensity Physical Activity" <- wide_d10$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity` + wide_d10$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity`
wide_d10$"Sedentary Behaviour" <- wide_d10$`Leisure Time Sedentary Behaviour` + wide_d10$`Social-Based Sedentary Behaviour` + wide_d10$`Recreational Screen Time` + wide_d10$`Education-Based Sedentary Behaviour` + wide_d10$`Self Care Sedentary Behaviour` + wide_d10$`Passive Transportation`
wide_d10$"Sleep" <- wide_d10$`Daytime Naps` + wide_d10$`Nighttime Sleep`

#Rename movement behaviour variables to be "at 10" 
rename(wide_d10, c("Light-Intensity Physical Activity at 10" = "Light-Intensity Physical Activity", "Moderate- to Vigorous- Intensity Physical Activity at 10" = "Moderate- to Vigorous- Intensity Physical Activity", "Sedentary Behaviour at 10" = "Sedentary Behaviour", "Sleep at 10" = "Sleep", "Work and Household Light-Intensity Physical Activity at 10" = "Work and Household Light-Intensity Physical Activity", "Unstructured Leisure Time Light-Intensity Physical Activity at 10" = "Unstructured Leisure Time Light-Intensity Physical Activity", "Active Transportation at 10" = "Active Transportation", "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 10" = "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity", "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 10" = "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity", "Leisure Time Sedentary Behaviour at 10" = "Leisure Time Sedentary Behaviour", "Social-Based Sedentary Behaviour at 10" = "Social-Based Sedentary Behaviour", "Recreational Screen Time at 10" = "Recreational Screen Time", "Education-Based Sedentary Behaviour at 10" = "Education-Based Sedentary Behaviour", "Self Care Sedentary Behaviour at 10" = "Self Care Sedentary Behaviour", "Daytime Naps at 10" = "Daytime Naps", "Nighttime Sleep at 10" = "Nighttime Sleep", "Passive Transportation at 10" = "Passive Transportation", "Awake Time at 10" ="awake_time_num", "Sleep Time at 10" = "sleep_time_num", "Uncodeable Activity at 10" = "Uncodeable Activity")) -> wide_d10

#Add general movement behaviours together to see if they equal a 24 hour day (1440 minutes)
wide_d10$total_general_movement_behaviours <- wide_d10$`Sedentary Behaviour at 10` + wide_d10$`Moderate- to Vigorous- Intensity Physical Activity at 10` + wide_d10$`Light-Intensity Physical Activity at 10` + wide_d10$`Sleep at 10` + wide_d10$`Uncodeable Activity at 10`
#Add domain-specific movement behaviours together to see if they equal a 24 hour day (1440 minutes)
wide_d10$total_domain_specific_movement_behaviours <- wide_d10$`Active Transportation at 10` + wide_d10$`Work and Household Light-Intensity Physical Activity at 10` + wide_d10$`Unstructured Leisure Time Light-Intensity Physical Activity at 10` + wide_d10$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 10` + wide_d10$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 10` + wide_d10$`Leisure Time Sedentary Behaviour at 10` + wide_d10$`Social-Based Sedentary Behaviour at 10` + wide_d10$`Recreational Screen Time at 10` + wide_d10$`Education-Based Sedentary Behaviour at 10` + wide_d10$`Self Care Sedentary Behaviour at 10` + wide_d10$`Passive Transportation at 10` + wide_d10$`Daytime Naps at 10` + wide_d10$`Nighttime Sleep at 10` + wide_d10$`Uncodeable Activity at 10`
#Filter by participants who are over 1440 minutes to see what the issue is 
wide_d10[wide_d10$total_general_movement_behaviours > 1440,]
#These participants had typos in their diary, but weren't flagged in the original TUD. Delete these participants because they should have been flagged by alarm1. 
wide_d10 <- wide_d10[!(wide_d10$total_general_movement_behaviours > 1440),]
#Participants are either at or under 1440 minutes; filter the participants who have less than 1440 minutes to figure out why this is the case
wide_d10[wide_d10$total_general_movement_behaviours < 1440,]
#Participants who are under 1440 minutes have different "awake time" and "start time" for their first activity; the time between these activities matched the time these participants were under a total day 
#Check the extreme cases to see if this is still true
wide_d10[wide_d10$total_general_movement_behaviours < 1400,]
#Yep!
#Change -9 in remoteness and school to NA. First see if there are any -9 on school days
wide_d10[(wide_d10$school == -9) & !(wide_d10$day == 6 | wide_d10$day == 7),] 
#Nope! Happy news! Now change -9 to 2 since the children were not in school 
wide_d10$school[wide_d10$school == -9] <- 2
wide_d10
```

```{r eval=FALSE, include=FALSE}
wide_d10 -> wide_d10_outliers
hist(wide_d10_outliers$`Active Transportation at 10`)
wide_d10_outliers[wide_d10_outliers$`Active Transportation at 10` > 300,]
#Very abnormal; 10 year-olds don't walk from 7pm to 1 in the morning! 
wide_d10_outliers[((wide_d10_outliers$`Active Transportation at 10` > 240) & (wide_d10_outliers$`Active Transportation at 10` <= 300)),]
#Seems a bit odd that one kids walked for 4.5 hours, but everything else is normal. Keep 
hist(wide_d10_outliers$`Daytime Naps at 10`)
wide_d10_outliers[wide_d10_outliers$`Daytime Naps at 10` > 300,]
#Top 2 times appear to reports of a restless night sleep, not naps;covert these to nighttime sleep  
wide_d10_outliers[wide_d10_outliers$`Daytime Naps at 10` >= 240,]
#Same as above, woke up early to have a drink and then went back to bed for several hours before starting the day except participant exactly at 240 min; convert to nighttime sleep (not 240 participant)
wide_d10_outliers[((wide_d10_outliers$`Daytime Naps at 10` >= 180) & (wide_d10_outliers$`Daytime Naps at 10` <= 240)),]
#Long naps, but nothing abnormal
hist(wide_d10_outliers$`Education-Based Sedentary Behaviour at 10`)
wide_d10_outliers[wide_d10_outliers$`Education-Based Sedentary Behaviour at 10` > 600,]
#Education looks OK, longer instances are after school classes and homework
hist(wide_d10_outliers$`Leisure Time Sedentary Behaviour at 10`)
wide_d10_outliers[wide_d10_outliers$`Leisure Time Sedentary Behaviour at 10` > 600,]
#4/6 reported eating for almost the entire day; definitely exclude >700
wide_d10_outliers[((wide_d10_outliers$`Leisure Time Sedentary Behaviour at 10` >= 550) & (wide_d10_outliers$`Leisure Time Sedentary Behaviour at 10` < 600)),]
#All 550 minutes exactly looked OK, greater than 550 had an abnormally long amount of eating/drink time (3.75+ hours) or several activities were labeled as "not in coder" but were coded as eating/drinking; exclude
hist(wide_d10_outliers$`Passive Transportation at 10`)
wide_d10_outliers[wide_d10_outliers$`Passive Transportation at 10` >= 400,]
wide_d10_outliers[((wide_d10_outliers$`Passive Transportation at 10` > 300) & (wide_d10_outliers$`Passive Transportation at 10` < 400)),]
#Lower ends it looks like a typical day with long commutes; higher ends are mixed with abnormal days and 
wide_d10_outliers[((wide_d10_outliers$`Passive Transportation at 10` > 360) & (wide_d10_outliers$`Passive Transportation at 10` <= 400)),]
wide_d10_outliers[((wide_d10_outliers$`Passive Transportation at 10` > 300) & (wide_d10_outliers$`Passive Transportation at 10` <= 360)),]
#All activites at 301 min appeared to be normal days with longer commuters
wide_d10_outliers[((wide_d10_outliers$`Passive Transportation at 10` > 240) & (wide_d10_outliers$`Passive Transportation at 10` <= 300)),]
#Appear to be normal days 
hist(wide_d10_outliers$`Recreational Screen Time at 10`)
wide_d10_outliers[wide_d10_outliers$`Recreational Screen Time at 10` > 400,]
#Looks like normal days
hist(wide_d10_outliers$`Self Care Sedentary Behaviour at 10`)
wide_d10_outliers[wide_d10_outliers$`Self Care Sedentary Behaviour at 10` > 300,]
#Both children with Self Care SB >300min were sick; consider excluding because they are outliers due to their illness which is not a typical day 
wide_d10_outliers[wide_d10_outliers$`Self Care Sedentary Behaviour at 10` > 250,]
#1 extra participant, activity "take medication" lasted for 4.5 hours starting at 4:30am; consider also making an outlier 
wide_d10_outliers[wide_d10_outliers$`Self Care Sedentary Behaviour at 10` > 150,]
#3 extra participants; either sick, at the hospital, or taking medication 
wide_d10_outliers[((wide_d10_outliers$`Self Care Sedentary Behaviour at 10` > 120) & (wide_d10_outliers$`Self Care Sedentary Behaviour at 10` <= 150)),]
#Doctor appointments 
wide_d10_outliers[((wide_d10_outliers$`Self Care Sedentary Behaviour at 10` > 90) & (wide_d10_outliers$`Self Care Sedentary Behaviour at 10`<= 120)),]
#4 sick, 2 appointments, 1 massage
wide_d10_outliers[(wide_d10_outliers$`Self Care Sedentary Behaviour at 10` == 90),]
wide_d10_outliers[((wide_d10_outliers$`Self Care Sedentary Behaviour at 10` >= 60) & (wide_d10_outliers$`Self Care Sedentary Behaviour at 10` < 90)),]
#All appointments or hospital visits, but there are 128 participants that fall into this category. I don't think they would be considered outliers
hist(wide_d10_outliers$`Social-Based Sedentary Behaviour at 10`)
wide_d10_outliers[wide_d10_outliers$`Social-Based Sedentary Behaviour at 10` >= 600,]
#Looks OK
hist(wide_d10_outliers$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 10`)
wide_d10_outliers[wide_d10_outliers$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 10` > 350,]
#All playing team sports - they appear to be at competition weekends or camps, exclude because although they may be typical weekends it is reasonable to think that the participants were resting/waiting for long periods during their MVPA; therefore, these numbers are probably not accurate in terms of movement
hist(wide_d10_outliers$`Unstructured Leisure Time Light-Intensity Physical Activity at 10`)
wide_d10_outliers[wide_d10_outliers$`Unstructured Leisure Time Light-Intensity Physical Activity at 10` >= 600,]
#Participant with 660 minutes looks abnormal; only had 5 activies for the whole day with an 11 hour bushwalk with no breaks and straight to bed
wide_d10_outliers[((wide_d10_outliers$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 10` > 330) & (wide_d10_outliers$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 10` <= 360)),]
#Aligned with structured MVPA
hist(wide_d10_outliers$`Work and Household Light-Intensity Physical Activity at 10`)
wide_d10_outliers[wide_d10_outliers$`Work and Household Light-Intensity Physical Activity at 10`> 400,]
#Participant with only 800 min only recorded 1 activity for the entire day; all other participants looked like they were doirng chores all day - seemed reasonable as it was broken up with break for eating, etc. 
hist(wide_d10_outliers$`Nighttime Sleep at 10`)
wide_d10_outliers[wide_d10_outliers$`Nighttime Sleep at 10` >= 1000,]
#Could be a typical weekend; no mention of being sick
wide_d10_outliers[((wide_d10_outliers$`Nighttime Sleep at 10` > 840) & (wide_d10_outliers$`Nighttime Sleep at 10` <= 1000)),]
#Look like normal days; not mention of being sick

#Remove Wave 6 outliers
wide_d10_outliers <- wide_d10_outliers[!(wide_d10_outliers$`Active Transportation at 10` >= 300),]
#3 participants excluded
wide_d10_outliers <- wide_d10_outliers[!(wide_d10_outliers$`Leisure Time Sedentary Behaviour at 10` > 550),]
#11 participants excluded
wide_d10_outliers <- wide_d10_outliers[!(wide_d10_outliers$`Passive Transportation at 10` >= 302),]
#32 participants excluded
wide_d10_outliers <- wide_d10_outliers[!(wide_d10_outliers$`Self Care Sedentary Behaviour at 10` >= 90),]
#79 participants excluded
wide_d10_outliers <- wide_d10_outliers[!(wide_d10_outliers$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 10` >= 350),]
#7 participants excluded
wide_d10_outliers <- wide_d10_outliers[!(wide_d10_outliers$`Unstructured Leisure Time Light-Intensity Physical Activity at 10` > 660),]
#1 participants met critiera, but was excluded in one of the above code lines - therefore no further participants were excluded at this step 
wide_d10_outliers <- wide_d10_outliers[!(wide_d10_outliers$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 10` >= 350),]
#3 participants excluded
wide_d10_outliers <- wide_d10_outliers[!(wide_d10_outliers$`Work and Household Light-Intensity Physical Activity at 10` >= 800),]
#1 participant excluded
wide_d10_outliers <- wide_d10_outliers[!(wide_d10_outliers$`Nighttime Sleep at 10` >= 1000),] -> wide_d10_outliers_removed
#1 participant excluded

```

```{r eval=FALSE, include=FALSE}
#Decide how many profiles should be used for latent profile analysis for general movement behaviours (This is just a test to make sure this works with the dataset; we'll do a multi trajectory analysis with the longitudinal data)
 
#clean_names(wide_d10) %>%
 #select(sedentary_behaviour_at_10, light_intensity_physical_activity_at_10, moderate_to_vigorous_intensity_physical_activity_at_10, sleep_at_10) %>% 
 #estimate_profiles(1:6,
             #      variances = c("equal", "varying", "varying", "equal"),
             #      covariances = c("zero", "varying", "zero", "equal"))%>% 
 # compare_solutions (statistics = c("AIC", "BIC"))

#Results say Model 6 with 5 classes is the best fit solution
#clean_names(wide_d10) %>% 
 # select(sedentary_behaviour_at_10, light_intensity_physical_activity_at_10, moderate_to_vigorous_intensity_physical_activity_at_10, sleep_at_10) %>% 
  #estimate_profiles(5, 
              #      variances = "varying",
                #    covariances = "varying") %>% 
 # plot_profiles()

#Decide how many profiles should be used for latent profile analysis for domain-specific movement behaviours (This is just a test to make sure this works with the dataset; we'll do a multi trajectory analysis with the longitudinal data)
 
#clean_names(wide_d10) %>%
 # select(unstructured_leisure_time_light_intensity_physical_activity_at_10, work_and_household_light_intensity_physical_activity_at_10, active_transportation_at_10, structured_leisure_time_moderate_to_vigorous_intensity_physical_activity_at_10, unstructured_leisure_time_moderate_to_vigorous_intensity_physical_activity_at_10, education_based_sedentary_behaviour_at_10, leisure_time_sedentary_behaviour_at_10, passive_transportation_at_10, recreational_screen_time_at_10, social_based_sedentary_behaviour_at_10, daytime_naps_at_10, nighttime_sleep_at_10) %>% 
  #estimate_profiles(1:6,
                  #  variances = c("equal", "varying", "varying", "equal"),
                  #  covariances = c("zero", "varying", "zero", "equal"))%>% 
 # compare_solutions (statistics = c("AIC", "BIC"))

#Results say Model 3 with 6 classes is the best fit solution
#clean_names(wide_d10) %>%
  #select(unstructured_leisure_time_light_intensity_physical_activity_at_10, work_and_household_light_intensity_physical_activity_at_10, active_transportation_at_10, structured_leisure_time_moderate_to_vigorous_intensity_physical_activity_at_10, unstructured_leisure_time_moderate_to_vigorous_intensity_physical_activity_at_10, education_based_sedentary_behaviour_at_10, leisure_time_sedentary_behaviour_at_10, passive_transportation_at_10, recreational_screen_time_at_10, social_based_sedentary_behaviour_at_10, daytime_naps_at_10, nighttime_sleep_at_10) %>% 
 # estimate_profiles(6,
               #     variances = c("equal"),
                #    covariances = c("equal"))%>% 
 # plot_profiles()

```

```{r include=FALSE}
#Code from 20JULY2020
#Calculate time spent in each behaviour for TUd12
d12 <- relevantcols12 %>% 
#Group activities by participant 
  group_by(hicid) %>% 
#Assign start time of following actives as "end time", make numeric so later on times that occur after midnight can be subtracted without becoming negative
  mutate(end_time_num = as.numeric(lead(stime))) %>%
#Make start and sleep times as numeric to avoid negative midnight problem 
  mutate(start_time_num = as.numeric(stime)) %>%
  mutate(sleep_time_num = as.numeric(sleep)) %>% 
  mutate(awake_time_num = as.numeric(awake))
#Take care of alarm1 by deleting these participants; alarm1 refers to start times that were recorded incorrectly or out of order, this can potentially screw up the data and we do not want to make assumptions about the participants'activities so we will not include them in our analysis 
d12[d12$alarm1 == 1,]
d12 <- d12[!(d12$alarm1==1),]
#Take care of alarm2: this is when activities were recorded after bedtime, but before wake up time. We will delete these activities that occur after sleep time because their duration cannot be recorded. However, activities recorded after bedtime will remain because their duration can be calculated. 
d12[d12$alarm2 == 1,]
d12 <- d12[!((d12$alarm2 == 1) & (d12$stime >= d12$sleep)),]
#Assign last activities of the day to be NA since they don't have a time to be subtracted from 
before_sleep <- is.na(d12$end_time_num)
#sleep_midnight <- (d$sleep_time_num == 0) + 86400 (This was an attempt to solve the problem at the end of this chunk. Some end_times were incorrect)
#Assign sleep time to be end time for last activities of the day
d12$end_time_num[before_sleep] <- (d12$sleep_time_num[before_sleep])
#Add "1 day" to end times that occur after midnight 
next_day_finish <- (d12$end_time_num < d12$start_time_num) & !is.na(d12$end_time_num)
#table(next_day_finish)
d12$end_time_num[next_day_finish] <- (d12$end_time_num[next_day_finish] + 86400)
#Subtract start time from end time to get the total time spent in each activity 
d12$total_time_num <- d12$end_time_num - d12$start_time_num
#hist(d$total_time_num)

#Convert total time from seconds to minutes 
d12$total_minutes <- d12$total_time_num %/% 60
#Get rid of NAs for sleep time because nighttime sleep cannot be calculated, since less than 5% (6/3460) participants have missing sleep data it is OK to delete them without biasing the results 
d12[!is.na(d12$sleep_time_num),] -> d12_cleaned
d12_cleaned
```

```{r include=FALSE}
  
#Assign TUD activity codes to domain-specific variables for B-cohort at age 12  
unstr_lt_pa <- c(427, 428, 430, 454, 463, 464, 465, 466, 491, 450, 451)
wrk_hh_pa <- c(1,11,31,41,51, 61, 71, 82, 83, 84, 91, 201, 211, 221,231,301, 311, 321, 331, 341, 342, 344, 351, 361, 362, 363, 364, 365, 366, 367, 368, 371, 381)
active_trans <- c(901, 911)
str_lt_mvpa <- c(401, 402, 403, 404, 405, 406, 407, 408, 411, 412, 413, 414, 415, 416, 417, 418, 440)
unstr_lt_mvpa <- c(421, 422, 423, 424, 425, 426)
education_sb <- c(21, 81, 501, 521, 531, 541, 581, 601, 701)
lt_sb <- c(281, 312, 981, 481, 462, 101, 511, 542, 543, 544, 545, 548, 551, 552, 555, 561, 591, 452, 453, 455, 456, 457, 458, 471, 472, 473)
passive_trans <- c(921, 931, 941)
recreational_screentime <- c(461, 611, 612, 621, 631, 641, 651, 661, 671, 681, 691, 841, 851)
selfcare_sb <- c(241, 251, 261, 271)
social_sb <- c(802, 811, 821, 831, 861, 871, 881)
daytime_naps <- 571
uncodeable_activity <- c(971, 991, 998)
no_secact <- -9

#Add columns for domain-specific main and all secondary activities 
d12_cleaned %>% 
  mutate(domain_main_activity = case_when(
    mainact %in% unstr_lt_pa ~ "Unstructured Leisure Time Light Physical Activity",
    mainact %in% wrk_hh_pa ~ "Work and Household Light Physical Activity",
    mainact %in% active_trans ~ "Active Transportation",
    mainact %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    mainact %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    mainact %in% education_sb ~ "Education Based Sedentary Behaviour",
    mainact %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    mainact %in% passive_trans ~ "Passive Transportation",
    mainact %in% recreational_screentime ~ "Recreational Screen Time",
    mainact %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    mainact %in% social_sb ~ "Social Sedentary Behaviour",
    mainact %in% daytime_naps ~ "Daytime Naps",
    mainact %in% uncodeable_activity ~ "Uncodeable Activity")) %>% 
  mutate(domain_secondary1_activity = case_when(
    secact1 %in% unstr_lt_pa ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    secact1 %in% wrk_hh_pa ~ "Work and Household Light-Intensity Physical Activity",
    secact1 %in% active_trans ~ "Active Transportation",
    secact1 %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact1 %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact1 %in% education_sb ~ "Education-Based Sedentary Behaviour",
    secact1 %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    secact1 %in% passive_trans ~ "Passive Transportation",
    secact1 %in% recreational_screentime ~ "Recreational Screen Time",
    secact1 %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    secact1 %in% social_sb ~ "Social-Based Sedentary Behaviour",
    secact1 %in% daytime_naps ~ "Daytime Naps",
    secact1 %in% uncodeable_activity ~ "Uncodeable Activity",
    secact1 %in% no_secact ~ "None"
  )) %>% 
  mutate(domain_secondary2_activity = case_when(
    secact2 %in% unstr_lt_pa ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    secact2 %in% wrk_hh_pa ~ "Work and Household Light-Intensity Physical Activity",
    secact2 %in% active_trans ~ "Active Transportation",
    secact2 %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact2 %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact2 %in% education_sb ~ "Education-Based Sedentary Behaviour",
    secact2 %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    secact2 %in% passive_trans ~ "Passive Transportation",
    secact2 %in% recreational_screentime ~ "Recreational Screen Time",
    secact2 %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    secact2 %in% social_sb ~ "Social-Based Sedentary Behaviour",
    secact2 %in% daytime_naps ~ "Daytime Naps",
    secact2 %in% uncodeable_activity ~ "Uncodeable Activity",
    secact2 %in% no_secact ~ "None"
  )) %>% 
  mutate(domain_secondary3_activity = case_when(
    secact3 %in% unstr_lt_pa ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    secact3 %in% wrk_hh_pa ~ "Work and Household Light-Intensity Physical Activity",
    secact3 %in% active_trans ~ "Active Transportation",
    secact3 %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact3 %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact3 %in% education_sb ~ "Education-Based Sedentary Behaviour",
    secact3 %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    secact3 %in% passive_trans ~ "Passive Transportation",
    secact3 %in% recreational_screentime ~ "Recreational Screen Time",
    secact3 %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    secact3 %in% social_sb ~ "Social-Based Sedentary Behaviour",
    secact3 %in% daytime_naps ~ "Daytime Naps",
    secact3 %in% uncodeable_activity ~ "Uncodeable Activity",
    secact3 %in% no_secact ~ "None"
  ))  %>% 
#Make decision rules based on main activities and secondary activities 
  mutate(domain_specific_movement_behaviour = case_when(
    (mainact %in% unstr_lt_pa & secact1 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% no_secact) ~ "Active Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% education_sb & secact1 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% recreational_screentime & secact1 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% selfcare_sb & secact1 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% daytime_naps & secact1 %in% no_secact & !(hicid == 14105383)) ~ "Daytime Naps",
    (mainact %in% daytime_naps & secact1 %in% no_secact & (hicid == 14105383)) ~ "Nighttime Sleep 1",
    (mainact %in% uncodeable_activity & secact1 %in% no_secact) ~ "Uncodeable Activity",
    (mainact %in% unstr_lt_pa & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% education_sb & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% recreational_screentime & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% selfcare_sb & secact1 %in% selfcare_sb & secact2 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% daytime_naps & secact1 %in% daytime_naps & secact2 %in% no_secact) ~ "Daytime Naps",
    (mainact %in% uncodeable_activity & secact1 %in% uncodeable_activity & secact2 %in% no_secact) ~ "Uncodeable Activity",
    (mainact %in% unstr_lt_pa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% wrk_hh_pa & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% wrk_hh_pa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% social_sb & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% social_sb & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% social_sb & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_pa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% education_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% selfcare_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% selfcare_sb & secact1 %in% social_sb & secact2 %in% education_sb & secact3 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% active_trans & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% lt_sb & secact2 %in% no_secact & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% uncodeable_activity & secact3 %in% uncodeable_activity) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% wrk_hh_pa) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% social_sb) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% str_lt_mvpa & secact3 %in% social_sb) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% unstr_lt_mvpa) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% active_trans) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% active_trans & secact3 %in% lt_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% unstr_lt_mvpa & secact3 %in% wrk_hh_pa) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% education_sb & secact2 %in% str_lt_mvpa & secact3 %in% lt_sb) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% education_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% social_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% education_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% uncodeable_activity & secact3 %in% recreational_screentime) ~ "Recreational Screen Time",
    (mainact %in% unstr_lt_mvpa & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% str_lt_mvpa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% str_lt_mvpa & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% uncodeable_activity & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% education_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% unstr_lt_mvpa) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Active Transportation",
    (mainact %in% social_sb & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% recreational_screentime & secact3 %in% recreational_screentime) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% active_trans) ~ "Active Transportation",
    (mainact %in% unstr_lt_pa & secact1 %in% active_trans & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% unstr_lt_mvpa) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% lt_sb & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% recreational_screentime) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% unstr_lt_pa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% recreational_screentime) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% recreational_screentime) ~ "Active Transportation",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% unstr_lt_pa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% daytime_naps & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Daytime Naps",
    (mainact %in% active_trans & secact1 %in% unstr_lt_pa & secact2 %in% no_secact & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% recreational_screentime & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% recreational_screentime) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% education_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% str_lt_mvpa & secact1 %in% unstr_lt_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% wrk_hh_pa & secact2 %in% recreational_screentime & secact3 %in% lt_sb) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% str_lt_mvpa & secact2 %in% recreational_screentime & secact3 %in% recreational_screentime) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% str_lt_mvpa & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% str_lt_mvpa & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% active_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% unstr_lt_pa & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% daytime_naps & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Daytime Naps",
    (mainact %in% passive_trans & secact1 %in% education_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% passive_trans & secact3 %in% lt_sb) ~ "Active Transportation",
    (mainact %in% passive_trans & secact1 %in% unstr_lt_pa & secact2 %in% active_trans & secact3 %in% social_sb) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% uncodeable_activity & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% social_sb & secact1 %in% str_lt_mvpa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% active_trans & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% education_sb & secact1 %in% social_sb & secact2 %in% active_trans & secact3 %in% passive_trans) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% wrk_hh_pa) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% str_lt_mvpa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% lt_sb) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% lt_sb) ~ "Active Transportation",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% recreational_screentime) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% unstr_lt_pa & secact3 %in% social_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% recreational_screentime & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% education_sb & secact1 %in% passive_trans & secact2 %in% lt_sb) ~ "Passive Transportation",
    (mainact %in% selfcare_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% unstr_lt_mvpa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% unstr_lt_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_mvpa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% str_lt_mvpa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% daytime_naps & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% wrk_hh_pa) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% social_sb) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% daytime_naps & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% recreational_screentime & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% recreational_screentime & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% passive_trans & secact3 %in% recreational_screentime) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% passive_trans & secact2 %in% passive_trans & secact3 %in% recreational_screentime) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% str_lt_mvpa & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% passive_trans & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% wrk_hh_pa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & (secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% uncodeable_activity & (secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% passive_trans & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa |secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Passive Transportation",
    (mainact %in% active_trans & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb |secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa  | secact3 %in% unstr_lt_pa)) ~ "Active Transportation",
    (mainact %in% recreational_screentime & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_pa)) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & (secact1 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa) & (secact2 %in% social_sb | secact3 %in% social_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa) ) ~ "Recreational Screen Time",
    (secact1 %in% recreational_screentime & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa) & (secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb)) ~ "Recreational Screen Time",
    (mainact %in% str_lt_mvpa & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb |secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa)) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% unstr_lt_mvpa & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_pa | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% lt_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb |secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Leisure Time Sedentary Behaviour",
     (mainact %in% c(recreational_screentime, selfcare_sb, lt_sb, social_sb, wrk_hh_pa, education_sb, unstr_lt_pa, daytime_naps) & (secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Passive Transportation",
   (mainact %in% selfcare_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Self Care Sedentary Behaviour",
   (mainact %in% education_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Education-Based Sedentary Behaviour",
   (mainact %in% social_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb) & (secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & (secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & (secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Social-Based Sedentary Behaviour",
   (mainact %in% daytime_naps & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa))  ~ "Daytime Naps",
   (mainact %in% wrk_hh_pa & (secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Work and Household Light-Intensity Physical Activity",
   (mainact %in% unstr_lt_pa & (secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa  | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans) & !(secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
   (secact1 %in% lt_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact2 %in% active_trans | secact3 %in% active_trans | secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact2 %in% no_secact | secact3 %in% no_secact) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Leisure Time Sedentary Behaviour",
   (secact1 %in% selfcare_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Self Care Sedentary Behaviour",
   (secact1 %in% education_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Education-Based Sedentary Behaviour",
   (secact2 %in% c(education_sb, recreational_screentime, lt_sb, selfcare_sb, no_secact, wrk_hh_pa, unstr_lt_pa, social_sb) & (mainact %in% uncodeable_activity) & (secact1 %in% social_sb) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Social-Based Sedentary Behaviour",
   (secact2 %in% education_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact1 %in% uncodeable_activity) & !(secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Education-Based Sedentary Behaviour",
   (secact1 %in% social_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% lt_sb | secact3 %in% lt_sb |secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime) & !(secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Social-Based Sedentary Behaviour",
   (secact2 %in% recreational_screentime & (mainact %in% uncodeable_activity) & (secact1 %in% uncodeable_activity)) ~ "Recreational Screen Time",
   (secact2 %in% lt_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact1 %in% uncodeable_activity) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Leisure Time Sedentary Behaviour",
   (secact2 %in% selfcare_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Self Care Sedentary Behaviour",
   (secact3 %in% recreational_screentime & (mainact %in% uncodeable_activity) & (secact1 %in% uncodeable_activity) & (secact2 %in% uncodeable_activity)) ~ "Recreational Screen Time",
   (secact3 %in% lt_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact1 %in% uncodeable_activity | secact1 %in% daytime_naps) & (secact2 %in% wrk_hh_pa | secact2 %in% unstr_lt_pa | secact2 %in% uncodeable_activity | secact2 %in% daytime_naps | secact2 %in% social_sb) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Leisure Time Sedentary Behaviour",
   (secact1 %in% recreational_screentime & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact2 %in% daytime_naps | secact2 %in% lt_sb | secact2 %in% education_sb | secact2 %in% selfcare_sb | secact2 %in% social_sb) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Recreational Screen Time",
   (mainact %in% recreational_screentime & (secact1 %in% str_lt_mvpa) & (total_minutes > 60)) ~ "Recreational Screen Time",
   (mainact %in% recreational_screentime & (secact1 %in% str_lt_mvpa) & !(secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% education_sb | secact3 %in% education_sb) & total_minutes <= 60) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% recreational_screentime & (secact1 %in% unstr_lt_mvpa) & !(secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% education_sb | secact3 %in% education_sb) & total_minutes <= 60) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% recreational_screentime & (secact1 %in% unstr_lt_mvpa) & total_minutes > 60) ~ "Recreational Screen Time",
   (mainact %in% wrk_hh_pa & (secact1 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa) & (secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb)) ~ "Work and Household Light-Intensity Physical Activity",
   (mainact %in% unstr_lt_pa & (secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
   (mainact %in% unstr_lt_pa & (secact1 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact1 %in% social_sb) & (secact2 %in% education_sb | secact3 %in% education_sb |  secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% social_sb | secact3 %in% social_sb)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
   (mainact %in% uncodeable_activity & secact1 %in% unstr_lt_pa & !(secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity"
    
  )) -> long_d12

#Check to make sure there are no missing decisions
#long_d12[is.na(long_d12$domain_specific_movement_behaviour),]

#Convert dataset from long to wide format 
long_d12 %>% 
  dcast(hicid + awake_time_num + sleep_time_num + day + school ~ c(domain_specific_movement_behaviour), value.var="total_minutes", fun.aggregate = sum) -> wide_d12



#Calculate Nighttime Sleep 
#Make variable for subjects who went to sleep before midnight
sleep_before_midnight <- !is.na(wide_d12$sleep_time_num) & (wide_d12$sleep_time_num > 43200)
#Make variable for subjects who went to sleep after midnight 
sleep_after_midnight <- !is.na(wide_d12$sleep_time_num) & (wide_d12$sleep_time_num <= 43200)

#For subjects who went to sleep before midnight, subtract their sleep time from 86400 
sleep_to_midnight_calculation <- (86400 - wide_d12$sleep_time_num[sleep_before_midnight])
#For the same subjects, add above calculation to their wake time to get their total sleep time 
total_sleep_before_midnight <- wide_d12$awake_time_num[sleep_before_midnight] + sleep_to_midnight_calculation
#Put calculation into dataset 
wide_d12$sleep_time_num[sleep_before_midnight] <- total_sleep_before_midnight
hist(total_sleep_before_midnight)
#For subjects who went to sleep after midnight, subtract sleep time from wake time 
total_sleep_after_midnight <- wide_d12$awake_time_num[sleep_after_midnight] - wide_d12$sleep_time_num[sleep_after_midnight]
#Put calculation into dataset 
wide_d12$sleep_time_num[sleep_after_midnight] <- total_sleep_after_midnight
hist(total_sleep_after_midnight)
#Convert sleep time into minutes 
nighttime_sleep <- wide_d12$sleep_time_num / 60
#Add nighttime sleep into dataset
wide_d12$"Nighttime Sleep 2" <- (nighttime_sleep)
wide_d12$"Nighttime Sleep" <- wide_d12$`Nighttime Sleep 1` + wide_d12$`Nighttime Sleep 2`
wide_d12 <- wide_d12 %>%  select(-c(`Nighttime Sleep 1`, `Nighttime Sleep 2`))
#Add new columns for general movement behaviours
wide_d12$"Light-Intensity Physical Activity" <- wide_d12$`Active Transportation` + wide_d12$`Work and Household Light-Intensity Physical Activity` + wide_d12$`Unstructured Leisure Time Light-Intensity Physical Activity`
wide_d12$"Moderate- to Vigorous- Intensity Physical Activity" <- wide_d12$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity` + wide_d12$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity`
wide_d12$"Sedentary Behaviour" <- wide_d12$`Leisure Time Sedentary Behaviour` + wide_d12$`Social-Based Sedentary Behaviour` + wide_d12$`Recreational Screen Time` + wide_d12$`Education-Based Sedentary Behaviour` + wide_d12$`Self Care Sedentary Behaviour` + wide_d12$`Passive Transportation`
wide_d12$"Sleep" <- wide_d12$`Daytime Naps` + wide_d12$`Nighttime Sleep` 

#Rename movement behaviour variables to be "at 10" 
rename(wide_d12, c("Light-Intensity Physical Activity at 12" = "Light-Intensity Physical Activity", "Moderate- to Vigorous- Intensity Physical Activity at 12" = "Moderate- to Vigorous- Intensity Physical Activity", "Sedentary Behaviour at 12" = "Sedentary Behaviour", "Sleep at 12" = "Sleep", "Work and Household Light-Intensity Physical Activity at 12" = "Work and Household Light-Intensity Physical Activity", "Unstructured Leisure Time Light-Intensity Physical Activity at 12" = "Unstructured Leisure Time Light-Intensity Physical Activity", "Active Transportation at 12" = "Active Transportation", "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 12" = "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity", "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 12" = "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity", "Leisure Time Sedentary Behaviour at 12" = "Leisure Time Sedentary Behaviour", "Social-Based Sedentary Behaviour at 12" = "Social-Based Sedentary Behaviour", "Recreational Screen Time at 12" = "Recreational Screen Time", "Education-Based Sedentary Behaviour at 12" = "Education-Based Sedentary Behaviour", "Self Care Sedentary Behaviour at 12" = "Self Care Sedentary Behaviour", "Daytime Naps at 12" = "Daytime Naps", "Nighttime Sleep at 12" = "Nighttime Sleep", "Passive Transportation at 12" = "Passive Transportation", "Awake Time at 12" ="awake_time_num", "Sleep Time at 12" = "sleep_time_num", "Uncodeable Activity at 12" = "Uncodeable Activity")) -> wide_d12

#Add general movement behaviours together to see if they equal a 24 hour day (1440 minutes)
wide_d12$total_general_movement_behaviours <- wide_d12$`Sedentary Behaviour at 12` + wide_d12$`Moderate- to Vigorous- Intensity Physical Activity at 12` + wide_d12$`Light-Intensity Physical Activity at 12` + wide_d12$`Sleep at 12` + wide_d12$`Uncodeable Activity at 12`
#Add domain-specific movement behaviours together to see if they equal a 24 hour day (1440 minutes)
wide_d12$total_domain_specific_movement_behaviours <- wide_d12$`Active Transportation at 12` + wide_d12$`Work and Household Light-Intensity Physical Activity at 12` + wide_d12$`Unstructured Leisure Time Light-Intensity Physical Activity at 12` + wide_d12$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 12` + wide_d12$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 12` + wide_d12$`Leisure Time Sedentary Behaviour at 12` + wide_d12$`Social-Based Sedentary Behaviour at 12` + wide_d12$`Recreational Screen Time at 12` + wide_d12$`Education-Based Sedentary Behaviour at 12` + wide_d12$`Self Care Sedentary Behaviour at 12` + wide_d12$`Passive Transportation at 12` + wide_d12$`Daytime Naps at 12` + wide_d12$`Nighttime Sleep at 12` + wide_d12$`Uncodeable Activity at 12`
#Filter by participants who are over 1440 minutes to see what the issue is 
wide_d12[wide_d12$total_general_movement_behaviours > 1440,]
#These participants had typos in their diary, but weren't flagged in the original TUD. Delete these participants because they should have been flagged by alarm1. 
wide_d12 <- wide_d12[!(wide_d12$total_general_movement_behaviours > 1440),]
#Participants are either at or under 1440 minutes; filter the participants who have less than 1440 minutes to figure out why this is the case
wide_d12[wide_d12$total_general_movement_behaviours < 1440,]
#Participants who are under 1440 minutes have different "awake time" and "start time" for their first activity; the time between these activities matched the time these participants were under a total day 
#Check the extreme cases to see if this is still true
wide_d12[wide_d12$total_general_movement_behaviours < 1400,]
#Change -9 in remoteness and school to NA. First see if there are any -9 on school days
wide_d12[(wide_d12$school == -9) & !(wide_d12$day == 6 | wide_d12$day == 7),] 
#Nope! Happy news! Now change -9 to 2 since the children were not in school 
wide_d12$school[wide_d12$school == -9] <- 2
wide_d12

```

```{r}
wide_d12 -> wide_d12_outliers
hist(wide_d12_outliers$`Active Transportation at 12`)
wide_d12_outliers[wide_d12_outliers$`Active Transportation at 12` > 300,]
#Very abnormal; 10 year-olds don't walk from 7pm to 1 in the morning! 
wide_d12_outliers[((wide_d12_outliers$`Active Transportation at 12` > 240) & (wide_d12_outliers$`Active Transportation at 12` <= 300)),]
#Same as previous wave
hist(wide_d12_outliers$`Daytime Naps at 12`)
wide_d12_outliers[wide_d12_outliers$`Daytime Naps at 12` > 300,]
#Mainly just long naps; 14105383 restless nighttime sleep - convert this one
hist(wide_d12_outliers$`Education-Based Sedentary Behaviour at 12`)
wide_d12_outliers[wide_d12_outliers$`Education-Based Sedentary Behaviour at 12` > 600,]
#Education looks OK, longer instances are after school classes, homework, and reading
hist(wide_d12_outliers$`Leisure Time Sedentary Behaviour at 12`)
wide_d12_outliers[wide_d12_outliers$`Leisure Time Sedentary Behaviour at 12` > 600,]
#Looks OK
hist(wide_d12_outliers$`Passive Transportation at 12`)
wide_d12_outliers[wide_d12_outliers$`Passive Transportation at 12` >= 300,]
#300 minuts all long commutes; 305-330 mixed between long commutes and travel day; >330 exclude as outliers
hist(wide_d12_outliers$`Recreational Screen Time at 12`)
wide_d12_outliers[wide_d12_outliers$`Recreational Screen Time at 12` > 800,]
#Exclude >1000 because participant also didn't go to school that day for a special circumstance
hist(wide_d12_outliers$`Self Care Sedentary Behaviour at 12`)
wide_d12_outliers[wide_d12_outliers$`Self Care Sedentary Behaviour at 12` >= 90,]
hist(wide_d12_outliers$`Social-Based Sedentary Behaviour at 12`)
wide_d12_outliers[wide_d12_outliers$`Social-Based Sedentary Behaviour at 12` >= 600,]
#>800 same activity repeated in succession without other activities
hist(wide_d12_outliers$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 12`)
wide_d12_outliers[wide_d12_outliers$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 12` > 350,]
#All playing team sports - they appear to be at competition weekends or camps, exclude because although they may be typical weekends it is reasonable to think that the participants were resting/waiting for long periods during their MVPA; therefore, these numbers are probably not accurate in terms of movement
hist(wide_d12_outliers$`Unstructured Leisure Time Light-Intensity Physical Activity at 12`)
wide_d12_outliers[wide_d12_outliers$`Unstructured Leisure Time Light-Intensity Physical Activity at 12` >= 660,]
#Looks OK
wide_d12_outliers[wide_d12_outliers$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 12` > 350,]
#Aligned with structured MVPA
hist(wide_d12_outliers$`Work and Household Light-Intensity Physical Activity at 12`)
wide_d12_outliers[wide_d12_outliers$`Work and Household Light-Intensity Physical Activity at 12`> 800,]
#Diary entry seems incorrect
hist(wide_d12_outliers$`Nighttime Sleep at 12`)
wide_d12_outliers[wide_d12_outliers$`Nighttime Sleep at 12` >= 1000,]
#Could be a typical weekend; no mention of being sick
wide_d12_outliers[((wide_d12_outliers$`Nighttime Sleep at 12` > 840) & (wide_d12_outliers$`Nighttime Sleep at 12` <= 1000)),]
#Look like normal days; not mention of being sick

#Remove Wave 7 outliers
wide_d12_outliers <- wide_d12_outliers[!(wide_d12_outliers$`Active Transportation at 12` >= 300),]
#Removed 4 Wave 7 TUD
wide_d12_outliers <- wide_d12_outliers[!(wide_d12_outliers$`Passive Transportation at 12` > 330),]
#Removed 21 Wave 7 TUD
wide_d12_outliers <- wide_d12_outliers[!(wide_d12_outliers$`Recreational Screen Time at 12` > 1000),]
#Removed 1 Wave 7 TUD
wide_d12_outliers <- wide_d12_outliers[!(wide_d12_outliers$`Self Care Sedentary Behaviour at 12` >= 90),]
#Removed 20 Wave 7 TUD
wide_d12_outliers <- wide_d12_outliers[!(wide_d12_outliers$`Social-Based Sedentary Behaviour at 12` > 800),]
#Removed 1 Wave 7 TUD
wide_d12_outliers <- wide_d12_outliers[!(wide_d12_outliers$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 12` >= 350),]
#Removed 6 Wave 7 TUD
wide_d12_outliers <- wide_d12_outliers[!(wide_d12_outliers$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 12` >= 350),]
#Removed 10 Wave 7 TUD
wide_d12_outliers <- wide_d12_outliers[!(wide_d12_outliers$`Work and Household Light-Intensity Physical Activity at 12` > 800),]
#Removed 1 Wave 7 TUD
```



```{r include=FALSE}
#Code from 20JULY2020
#Calculate time spent in each behaviour for TUd14
d14 <- relevantcols14 %>% 
#Group activities by participant 
  group_by(hicid) %>% 
#Assign start time of following actives as "end time", make numeric so later on times that occur after midnight can be subtracted without becoming negative
  mutate(end_time_num = as.numeric(lead(stime))) %>%
#Make start and sleep times as numeric to avoid negative midnight problem 
  mutate(start_time_num = as.numeric(stime)) %>%
  mutate(sleep_time_num = as.numeric(sleep)) %>% 
  mutate(awake_time_num = as.numeric(awake))
#Take care of alarm1 by deleting these participants; alarm1 refers to start times that were recorded incorrectly or out of order, this can potentially screw up the data and we do not want to make assumptions about the participants'activities so we will not include them in our analysis 
d14[d14$alarm1 == 1,]
d14 <- d14[!(d14$alarm1==1),]
#Take care of alarm2: this is when activities were recorded after bedtime, but before wake up time. We will delete these activities that occur after sleep time because their duration cannot be recorded. However, activities recorded after bedtime will remain because their duration can be calculated. 
d14[d14$alarm2 == 1,]
d14 <- d14[!((d14$alarm2 == 1) & (d14$stime >= d14$sleep)),]
#Assign last activities of the day to be NA since they don't have a time to be subtracted from 
before_sleep <- is.na(d14$end_time_num)
#sleep_midnight <- (d$sleep_time_num == 0) + 86400 (This was an attempt to solve the problem at the end of this chunk. Some end_times were incorrect)
#Assign sleep time to be end time for last activities of the day
d14$end_time_num[before_sleep] <- (d14$sleep_time_num[before_sleep])
#Add "1 day" to end times that occur after midnight 
next_day_finish <- (d14$end_time_num < d14$start_time_num) & !is.na(d14$end_time_num)
#table(next_day_finish)
d14$end_time_num[next_day_finish] <- (d14$end_time_num[next_day_finish] + 86400)
#Subtract start time from end time to get the total time spent in each activity 
d14$total_time_num <- d14$end_time_num - d14$start_time_num
#hist(d$total_time_num)

#Convert total time from seconds to minutes 
d14$total_minutes <- d14$total_time_num %/% 60
#Get rid of NAs for sleep time because nighttime sleep cannot be calculated, since less than 5% (6/3460) participants have missing sleep data it is OK to delete them without biasing the results 
d14[!is.na(d14$sleep_time_num),] -> d14_cleaned
d14_cleaned
```

```{r include=FALSE}
  
#Assign TUD activity codes to domain-specific variables for B-cohort at age 14
unstr_lt_pa <- c(427, 428, 430, 454, 463, 464, 465, 466, 491, 450, 451)
wrk_hh_pa <- c(1,11,31,41,51, 61, 71, 82, 83, 84, 91, 201, 211, 221,231,301, 311, 321, 331, 341, 342, 344, 351, 361, 362, 363, 364, 365, 366, 367, 368, 371, 381)
active_trans <- c(901, 911)
str_lt_mvpa <- c(401, 402, 403, 404, 405, 406, 407, 408, 411, 412, 413, 414, 415, 416, 417, 418, 440)
unstr_lt_mvpa <- c(421, 422, 423, 424, 425, 426)
education_sb <- c(21, 81, 501, 521, 531, 541, 581, 601, 701)
lt_sb <- c(281, 312, 981, 481, 462, 101, 511, 542, 543, 544, 545, 548, 551, 552, 555, 561, 591, 452, 453, 455, 456, 457, 458, 471, 472, 473)
passive_trans <- c(921, 931, 941)
recreational_screentime <- c(461, 611, 612, 621, 631, 641, 651, 661, 671, 681, 691, 841, 851)
selfcare_sb <- c(241, 251, 261, 271)
social_sb <- c(802, 811, 821, 831, 861, 871, 881)
daytime_naps <- 571
uncodeable_activity <- c(971, 991, 998)
no_secact <- -9

#Add columns for domain-specific main and all secondary activities 
d14_cleaned %>% 
  mutate(domain_main_activity = case_when(
    mainact %in% unstr_lt_pa ~ "Unstructured Leisure Time Light Physical Activity",
    mainact %in% wrk_hh_pa ~ "Work and Household Light Physical Activity",
    mainact %in% active_trans ~ "Active Transportation",
    mainact %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    mainact %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    mainact %in% education_sb ~ "Education Based Sedentary Behaviour",
    mainact %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    mainact %in% passive_trans ~ "Passive Transportation",
    mainact %in% recreational_screentime ~ "Recreational Screen Time",
    mainact %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    mainact %in% social_sb ~ "Social Sedentary Behaviour",
    mainact %in% daytime_naps ~ "Daytime Naps",
    mainact %in% uncodeable_activity ~ "Uncodeable Activity")) %>% 
  mutate(domain_secondary1_activity = case_when(
    secact1 %in% unstr_lt_pa ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    secact1 %in% wrk_hh_pa ~ "Work and Household Light-Intensity Physical Activity",
    secact1 %in% active_trans ~ "Active Transportation",
    secact1 %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact1 %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact1 %in% education_sb ~ "Education-Based Sedentary Behaviour",
    secact1 %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    secact1 %in% passive_trans ~ "Passive Transportation",
    secact1 %in% recreational_screentime ~ "Recreational Screen Time",
    secact1 %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    secact1 %in% social_sb ~ "Social-Based Sedentary Behaviour",
    secact1 %in% daytime_naps ~ "Daytime Naps",
    secact1 %in% uncodeable_activity ~ "Uncodeable Activity",
    secact1 %in% no_secact ~ "None"
  )) %>% 
  mutate(domain_secondary2_activity = case_when(
    secact2 %in% unstr_lt_pa ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    secact2 %in% wrk_hh_pa ~ "Work and Household Light-Intensity Physical Activity",
    secact2 %in% active_trans ~ "Active Transportation",
    secact2 %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact2 %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact2 %in% education_sb ~ "Education-Based Sedentary Behaviour",
    secact2 %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    secact2 %in% passive_trans ~ "Passive Transportation",
    secact2 %in% recreational_screentime ~ "Recreational Screen Time",
    secact2 %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    secact2 %in% social_sb ~ "Social-Based Sedentary Behaviour",
    secact2 %in% daytime_naps ~ "Daytime Naps",
    secact2 %in% uncodeable_activity ~ "Uncodeable Activity",
    secact2 %in% no_secact ~ "None"
  )) %>% 
  mutate(domain_secondary3_activity = case_when(
    secact3 %in% unstr_lt_pa ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    secact3 %in% wrk_hh_pa ~ "Work and Household Light-Intensity Physical Activity",
    secact3 %in% active_trans ~ "Active Transportation",
    secact3 %in% str_lt_mvpa ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact3 %in% unstr_lt_mvpa ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    secact3 %in% education_sb ~ "Education-Based Sedentary Behaviour",
    secact3 %in% lt_sb ~ "Leisure Time Sedentary Behaviour",
    secact3 %in% passive_trans ~ "Passive Transportation",
    secact3 %in% recreational_screentime ~ "Recreational Screen Time",
    secact3 %in% selfcare_sb ~ "Self Care Sedentary Behaviour",
    secact3 %in% social_sb ~ "Social-Based Sedentary Behaviour",
    secact3 %in% daytime_naps ~ "Daytime Naps",
    secact3 %in% uncodeable_activity ~ "Uncodeable Activity",
    secact3 %in% no_secact ~ "None"
  ))  %>% 
#Make decision rules based on main activities and secondary activities 
  mutate(domain_specific_movement_behaviour = case_when(
    (mainact %in% unstr_lt_pa & secact1 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% no_secact) ~ "Active Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% education_sb & secact1 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% recreational_screentime & secact1 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% selfcare_sb & secact1 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% daytime_naps & secact1 %in% no_secact & (total_minutes < 350) | (total_minutes > 512)) ~ "Daytime Naps",
    (mainact %in% daytime_naps & secact1 %in% no_secact & (total_minutes > 349 & total_minutes < 512)) ~ "Nighttime Sleep 1",
    (mainact %in% uncodeable_activity & secact1 %in% no_secact) ~ "Uncodeable Activity",
    (mainact %in% unstr_lt_pa & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% education_sb & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% recreational_screentime & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% selfcare_sb & secact1 %in% selfcare_sb & secact2 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% daytime_naps & secact1 %in% daytime_naps & secact2 %in% no_secact) ~ "Daytime Naps",
    (mainact %in% uncodeable_activity & secact1 %in% uncodeable_activity & secact2 %in% no_secact) ~ "Uncodeable Activity",
    (mainact %in% unstr_lt_pa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% wrk_hh_pa & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% wrk_hh_pa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% social_sb & secact1 %in% unstr_lt_pa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% social_sb & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% social_sb & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_pa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% education_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% selfcare_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% selfcare_sb & secact1 %in% social_sb & secact2 %in% education_sb & secact3 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% active_trans & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% lt_sb & secact2 %in% no_secact & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% uncodeable_activity & secact3 %in% uncodeable_activity) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% wrk_hh_pa) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% social_sb) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% str_lt_mvpa & secact3 %in% social_sb) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% unstr_lt_mvpa) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% active_trans) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% active_trans & secact3 %in% lt_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% unstr_lt_mvpa & secact3 %in% wrk_hh_pa) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% education_sb & secact2 %in% str_lt_mvpa & secact3 %in% lt_sb) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% education_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% social_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% education_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% uncodeable_activity & secact3 %in% recreational_screentime) ~ "Recreational Screen Time",
    (mainact %in% unstr_lt_mvpa & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% str_lt_mvpa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_mvpa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% str_lt_mvpa & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% uncodeable_activity & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% education_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% unstr_lt_mvpa) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Active Transportation",
    (mainact %in% social_sb & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% recreational_screentime & secact3 %in% recreational_screentime) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% active_trans) ~ "Active Transportation",
    (mainact %in% unstr_lt_pa & secact1 %in% active_trans & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% unstr_lt_mvpa) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% lt_sb & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% recreational_screentime) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% recreational_screentime & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% active_trans & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% active_trans & secact1 %in% str_lt_mvpa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% unstr_lt_pa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% recreational_screentime) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% social_sb & secact3 %in% recreational_screentime) ~ "Active Transportation",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% unstr_lt_pa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% unstr_lt_mvpa & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% daytime_naps & secact1 %in% recreational_screentime & secact2 %in% no_secact) ~ "Daytime Naps",
    (mainact %in% active_trans & secact1 %in% unstr_lt_pa & secact2 %in% no_secact & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% active_trans & secact1 %in% unstr_lt_mvpa & secact2 %in% no_secact) ~ "Active Transportation",
    (mainact %in% lt_sb & secact1 %in% unstr_lt_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% recreational_screentime & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% recreational_screentime) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% education_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% str_lt_mvpa & secact1 %in% unstr_lt_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% wrk_hh_pa & secact2 %in% recreational_screentime & secact3 %in% lt_sb) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% str_lt_mvpa & secact2 %in% recreational_screentime & secact3 %in% recreational_screentime) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% str_lt_mvpa & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% lt_sb & secact1 %in% str_lt_mvpa & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% active_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% unstr_lt_pa & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% daytime_naps & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Daytime Naps",
    (mainact %in% passive_trans & secact1 %in% education_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% str_lt_mvpa & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% lt_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% recreational_screentime & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% passive_trans & secact2 %in% passive_trans & secact3 %in% lt_sb) ~ "Active Transportation",
    (mainact %in% passive_trans & secact1 %in% unstr_lt_pa & secact2 %in% active_trans & secact3 %in% social_sb) ~ "Passive Transportation",
    (mainact %in% lt_sb & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% wrk_hh_pa & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% uncodeable_activity & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% social_sb & secact1 %in% str_lt_mvpa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% active_trans & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% education_sb & secact1 %in% social_sb & secact2 %in% active_trans & secact3 %in% passive_trans) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% wrk_hh_pa) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% lt_sb & secact1 %in% passive_trans & secact2 %in% str_lt_mvpa & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% lt_sb) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% lt_sb) ~ "Active Transportation",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% passive_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% recreational_screentime) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% wrk_hh_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% unstr_lt_pa & secact3 %in% social_sb) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% education_sb & secact1 %in% wrk_hh_pa & secact2 %in% no_secact) ~ "Education-Based Sedentary Behaviour",
    (mainact %in% active_trans & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Active Transportation",
    (mainact %in% recreational_screentime & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% passive_trans & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% education_sb & secact1 %in% passive_trans & secact2 %in% lt_sb) ~ "Passive Transportation",
    (mainact %in% selfcare_sb & secact1 %in% lt_sb & secact2 %in% no_secact) ~ "Self Care Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% unstr_lt_mvpa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% social_sb & secact1 %in% unstr_lt_pa & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_mvpa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% passive_trans & secact1 %in% str_lt_mvpa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% social_sb & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% str_lt_mvpa & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% lt_sb & secact2 %in% daytime_naps & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% recreational_screentime & secact1 %in% lt_sb & secact2 %in% wrk_hh_pa & secact3 %in% wrk_hh_pa) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & secact1 %in% social_sb & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% unstr_lt_mvpa & secact1 %in% lt_sb & secact2 %in% lt_sb & secact3 %in% social_sb) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% daytime_naps & secact2 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% wrk_hh_pa & secact1 %in% recreational_screentime & secact2 %in% recreational_screentime & secact3 %in% no_secact) ~ "Work and Household Light-Intensity Physical Activity",
    (mainact %in% recreational_screentime & secact1 %in% recreational_screentime & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Recreational Screen Time",
    (mainact %in% wrk_hh_pa & secact1 %in% wrk_hh_pa & secact2 %in% passive_trans & secact3 %in% recreational_screentime) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% passive_trans & secact2 %in% passive_trans & secact3 %in% recreational_screentime) ~ "Passive Transportation",
    (mainact %in% passive_trans & secact1 %in% lt_sb & secact2 %in% str_lt_mvpa & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & secact1 %in% passive_trans & secact2 %in% passive_trans & secact3 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% wrk_hh_pa & secact1 %in% social_sb & secact2 %in% lt_sb & secact3 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% lt_sb & secact1 %in% social_sb & secact2 %in% no_secact) ~ "Leisure Time Sedentary Behaviour",
    (mainact %in% passive_trans & secact1 %in% education_sb & secact2 %in% no_secact) ~ "Passive Transportation",
    (mainact %in% social_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Social-Based Sedentary Behaviour",
    (mainact %in% unstr_lt_pa & (secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% uncodeable_activity & (secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
    (mainact %in% passive_trans & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa |secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Passive Transportation",
    (mainact %in% active_trans & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb |secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa  | secact3 %in% unstr_lt_pa | secact1 %in% passive_trans | secact2 %in% passive_trans  | secact3 %in% passive_trans)) ~ "Active Transportation",
    (mainact %in% recreational_screentime & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_pa)) ~ "Recreational Screen Time",
    (mainact %in% recreational_screentime & (secact1 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa) & (secact2 %in% social_sb | secact3 %in% social_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa) ) ~ "Recreational Screen Time",
    (secact1 %in% recreational_screentime & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa) & (secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb)) ~ "Recreational Screen Time",
    (mainact %in% str_lt_mvpa & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb |secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa)) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% unstr_lt_mvpa & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_pa | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa)) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% lt_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb |secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Leisure Time Sedentary Behaviour",
     (mainact %in% c(recreational_screentime, selfcare_sb, lt_sb, social_sb, wrk_hh_pa, education_sb, unstr_lt_pa, daytime_naps) & (secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Passive Transportation",
   (mainact %in% selfcare_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Self Care Sedentary Behaviour",
   (mainact %in% education_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Education-Based Sedentary Behaviour",
   (mainact %in% social_sb & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb) & (secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & (secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & (secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Social-Based Sedentary Behaviour",
   (mainact %in% daytime_naps & (secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa))  ~ "Daytime Naps",
   (mainact %in% wrk_hh_pa & (secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans | secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Work and Household Light-Intensity Physical Activity",
   (mainact %in% unstr_lt_pa & (secact1 %in% unstr_lt_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact1 %in% wrk_hh_pa | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact1 %in% daytime_naps | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact1 %in% uncodeable_activity | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact1 %in% social_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa  | secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans) & !(secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
   (secact1 %in% lt_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa | secact2 %in% active_trans | secact3 %in% active_trans | secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% social_sb | secact3 %in% social_sb | secact2 %in% wrk_hh_pa | secact3 %in% wrk_hh_pa | secact2 %in% unstr_lt_pa | secact3 %in% unstr_lt_pa | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% daytime_naps | secact3 %in% daytime_naps | secact2 %in% uncodeable_activity | secact3 %in% uncodeable_activity | secact2 %in% no_secact | secact3 %in% no_secact) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Leisure Time Sedentary Behaviour",
   (secact1 %in% selfcare_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Self Care Sedentary Behaviour",
   (secact1 %in% education_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Education-Based Sedentary Behaviour",
   (secact2 %in% c(education_sb, recreational_screentime, lt_sb, selfcare_sb, no_secact, wrk_hh_pa, unstr_lt_pa, social_sb) & (mainact %in% uncodeable_activity) & (secact1 %in% social_sb) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Social-Based Sedentary Behaviour",
   (secact2 %in% education_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact1 %in% uncodeable_activity) & !(secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact2 %in% passive_trans | secact3 %in% passive_trans)) ~ "Education-Based Sedentary Behaviour",
   (secact1 %in% social_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact2 %in% education_sb | secact3 %in% education_sb | secact2 %in% lt_sb | secact3 %in% lt_sb |secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime) & !(secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Social-Based Sedentary Behaviour",
   (secact2 %in% recreational_screentime & (mainact %in% uncodeable_activity) & (secact1 %in% uncodeable_activity)) ~ "Recreational Screen Time",
   (secact2 %in% lt_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact1 %in% uncodeable_activity) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Leisure Time Sedentary Behaviour",
   (secact2 %in% selfcare_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Self Care Sedentary Behaviour",
   (secact3 %in% recreational_screentime & (mainact %in% uncodeable_activity) & (secact1 %in% uncodeable_activity) & (secact2 %in% uncodeable_activity)) ~ "Recreational Screen Time",
   (secact3 %in% lt_sb & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact1 %in% wrk_hh_pa | secact1 %in% unstr_lt_pa | secact1 %in% uncodeable_activity | secact1 %in% daytime_naps) & (secact2 %in% wrk_hh_pa | secact2 %in% unstr_lt_pa | secact2 %in% uncodeable_activity | secact2 %in% daytime_naps | secact2 %in% social_sb) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Leisure Time Sedentary Behaviour",
   (secact1 %in% recreational_screentime & (mainact %in% wrk_hh_pa | mainact %in% unstr_lt_pa | mainact %in% uncodeable_activity) & (secact2 %in% daytime_naps | secact2 %in% lt_sb | secact2 %in% education_sb | secact2 %in% selfcare_sb | secact2 %in% social_sb) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Recreational Screen Time",
   (mainact %in% recreational_screentime & (secact1 %in% str_lt_mvpa) & (total_minutes > 60)) ~ "Recreational Screen Time",
   (mainact %in% recreational_screentime & (secact1 %in% str_lt_mvpa) & !(secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% education_sb | secact3 %in% education_sb) & total_minutes <= 60) ~ "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% recreational_screentime & (secact1 %in% unstr_lt_mvpa) & !(secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% education_sb | secact3 %in% education_sb) & total_minutes <= 60) ~ "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity",
   (mainact %in% recreational_screentime & (secact1 %in% unstr_lt_mvpa) & total_minutes > 60) ~ "Recreational Screen Time",
   (mainact %in% wrk_hh_pa & (secact1 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa) & (secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb)) ~ "Work and Household Light-Intensity Physical Activity",
   (mainact %in% unstr_lt_pa & (secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
   (mainact %in% unstr_lt_pa & (secact1 %in% str_lt_mvpa | secact1 %in% unstr_lt_mvpa | secact1 %in% social_sb) & (secact2 %in% education_sb | secact3 %in% education_sb |  secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact2 %in% lt_sb | secact3 %in% lt_sb | secact2 %in% social_sb | secact3 %in% social_sb)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity",
   (mainact %in% uncodeable_activity & secact1 %in% unstr_lt_pa & !(secact1 %in% recreational_screentime | secact2 %in% recreational_screentime | secact3 %in% recreational_screentime | secact1 %in% education_sb | secact2 %in% education_sb | secact3 %in% education_sb | secact1 %in% selfcare_sb | secact2 %in% selfcare_sb | secact3 %in% selfcare_sb | secact1 %in% lt_sb | secact2 %in% lt_sb | secact3 %in% lt_sb) & !(secact1 %in% str_lt_mvpa | secact2 %in% str_lt_mvpa | secact3 %in% str_lt_mvpa) & !(secact1 %in% unstr_lt_mvpa | secact2 %in% unstr_lt_mvpa | secact3 %in% unstr_lt_mvpa) & !(secact1 %in% passive_trans | secact2 %in% passive_trans | secact3 %in% passive_trans) & !(secact1 %in% active_trans | secact2 %in% active_trans | secact3 %in% active_trans)) ~ "Unstructured Leisure Time Light-Intensity Physical Activity"
    
  )) -> long_d14

#Check to make sure there are no missing decisions
#long_d14[is.na(long_d14$domain_specific_movement_behaviour),]

#Convert dataset from long to wide format 
long_d14 %>% 
  dcast(hicid + awake_time_num + sleep_time_num + day + school ~ c(domain_specific_movement_behaviour), value.var="total_minutes", fun.aggregate = sum) -> wide_d14

long_d14[long_d14$hicid == 11103490,]

#Calculate Nighttime Sleep 
#Make variable for subjects who went to sleep before midnight
sleep_before_midnight <- !is.na(wide_d14$sleep_time_num) & (wide_d14$sleep_time_num > 43200)
#Make variable for subjects who went to sleep after midnight 
sleep_after_midnight <- !is.na(wide_d14$sleep_time_num) & (wide_d14$sleep_time_num <= 43200)

#For subjects who went to sleep before midnight, subtract their sleep time from 86400 
sleep_to_midnight_calculation <- (86400 - wide_d14$sleep_time_num[sleep_before_midnight])
#For the same subjects, add above calculation to their wake time to get their total sleep time 
total_sleep_before_midnight <- wide_d14$awake_time_num[sleep_before_midnight] + sleep_to_midnight_calculation
#Put calculation into dataset 
wide_d14$sleep_time_num[sleep_before_midnight] <- total_sleep_before_midnight
hist(total_sleep_before_midnight)
#For subjects who went to sleep after midnight, subtract sleep time from wake time 
total_sleep_after_midnight <- wide_d14$awake_time_num[sleep_after_midnight] - wide_d14$sleep_time_num[sleep_after_midnight]
#Put calculation into dataset 
wide_d14$sleep_time_num[sleep_after_midnight] <- total_sleep_after_midnight
hist(total_sleep_after_midnight)
#Convert sleep time into minutes 
nighttime_sleep <- wide_d14$sleep_time_num / 60
#Add nighttime sleep into dataset
wide_d14$"Nighttime Sleep 2" <- (nighttime_sleep)
wide_d14$"Nighttime Sleep" <- wide_d14$`Nighttime Sleep 1` + wide_d14$`Nighttime Sleep 2`
wide_d14 <- wide_d14 %>%  select(-c(`Nighttime Sleep 1`, `Nighttime Sleep 2`))

#Add new columns for general movement behaviours
wide_d14$"Light-Intensity Physical Activity" <- wide_d14$`Active Transportation` + wide_d14$`Work and Household Light-Intensity Physical Activity` + wide_d14$`Unstructured Leisure Time Light-Intensity Physical Activity`
wide_d14$"Moderate- to Vigorous- Intensity Physical Activity" <- wide_d14$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity` + wide_d14$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity`
wide_d14$"Sedentary Behaviour" <- wide_d14$`Leisure Time Sedentary Behaviour` + wide_d14$`Social-Based Sedentary Behaviour` + wide_d14$`Recreational Screen Time` + wide_d14$`Education-Based Sedentary Behaviour` + wide_d14$`Self Care Sedentary Behaviour` + wide_d14$`Passive Transportation`
wide_d14$"Sleep" <- wide_d14$`Daytime Naps` + wide_d14$`Nighttime Sleep` 


#Rename movement behaviour variables to be "at 10" 
rename(wide_d14, c("Light-Intensity Physical Activity at 14" = "Light-Intensity Physical Activity", "Moderate- to Vigorous- Intensity Physical Activity at 14" = "Moderate- to Vigorous- Intensity Physical Activity", "Sedentary Behaviour at 14" = "Sedentary Behaviour", "Sleep at 14" = "Sleep", "Work and Household Light-Intensity Physical Activity at 14" = "Work and Household Light-Intensity Physical Activity", "Unstructured Leisure Time Light-Intensity Physical Activity at 14" = "Unstructured Leisure Time Light-Intensity Physical Activity", "Active Transportation at 14" = "Active Transportation", "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 14" = "Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity", "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 14" = "Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity", "Leisure Time Sedentary Behaviour at 14" = "Leisure Time Sedentary Behaviour", "Social-Based Sedentary Behaviour at 14" = "Social-Based Sedentary Behaviour", "Recreational Screen Time at 14" = "Recreational Screen Time", "Education-Based Sedentary Behaviour at 14" = "Education-Based Sedentary Behaviour", "Self Care Sedentary Behaviour at 14" = "Self Care Sedentary Behaviour", "Daytime Naps at 14" = "Daytime Naps", "Nighttime Sleep at 14" = "Nighttime Sleep", "Passive Transportation at 14" = "Passive Transportation", "Awake Time at 14" ="awake_time_num", "Sleep Time at 14" = "sleep_time_num", "Uncodeable Activity at 14" = "Uncodeable Activity")) -> wide_d14

#Add general movement behaviours together to see if they equal a 24 hour day (1440 minutes)
wide_d14$total_general_movement_behaviours <- wide_d14$`Sedentary Behaviour at 14` + wide_d14$`Moderate- to Vigorous- Intensity Physical Activity at 14` + wide_d14$`Light-Intensity Physical Activity at 14` + wide_d14$`Sleep at 14` + wide_d14$`Uncodeable Activity at 14`
#Add domain-specific movement behaviours together to see if they equal a 24 hour day (1440 minutes)
wide_d14$total_domain_specific_movement_behaviours <- wide_d14$`Active Transportation at 14` + wide_d14$`Work and Household Light-Intensity Physical Activity at 14` + wide_d14$`Unstructured Leisure Time Light-Intensity Physical Activity at 14` + wide_d14$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 14` + wide_d14$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 14` + wide_d14$`Leisure Time Sedentary Behaviour at 14` + wide_d14$`Social-Based Sedentary Behaviour at 14` + wide_d14$`Recreational Screen Time at 14` + wide_d14$`Education-Based Sedentary Behaviour at 14` + wide_d14$`Self Care Sedentary Behaviour at 14` + wide_d14$`Passive Transportation at 14` + wide_d14$`Daytime Naps at 14` + wide_d14$`Nighttime Sleep at 14` + wide_d14$`Uncodeable Activity at 14`
#Filter by participants who are over 1440 minutes to see what the issue is 
wide_d14[wide_d14$total_general_movement_behaviours > 1440,]
#These participants had typos in their diary, but weren't flagged in the original TUD. Delete these participants because they should have been flagged by alarm1. 
wide_d14 <- wide_d14[!(wide_d14$total_general_movement_behaviours > 1440),]
#Participants are either at or under 1440 minutes; filter the participants who have less than 1440 minutes to figure out why this is the case
wide_d14[wide_d14$total_general_movement_behaviours < 1440,]
#Participants who are under 1440 minutes have different "awake time" and "start time" for their first activity; the time between these activities matched the time these participants were under a total day 
#Check the extreme cases to see if this is still true
wide_d14[wide_d14$total_general_movement_behaviours < 1400,]
#Change -9 in remoteness and school to NA. First see if there are any -9 on school days
wide_d14[(wide_d14$school == -9) & !(wide_d14$day == 6 | wide_d14$day == 7),] 
#Nope! Happy news! Now change -9 to 2 since the children were not in school 
wide_d14$school[wide_d14$school == -9] <- 2
wide_d14
```

```{r}
wide_d14 -> wide_d14_outliers
hist(wide_d14_outliers$`Active Transportation at 14`)
wide_d14_outliers[wide_d14_outliers$`Active Transportation at 14` > 300,]
#6-hours straight with no breaks; sometimes paired with sedentary behaviour, remove
wide_d14_outliers[((wide_d14_outliers$`Active Transportation at 14` > 240) & (wide_d14_outliers$`Active Transportation at 14` <= 300)),]
#300 paired with uncodedable activity (main), 
hist(wide_d14_outliers$`Daytime Naps at 14`)
wide_d14_outliers[wide_d14_outliers$`Daytime Naps at 14` > 300,]
#Exclude >700 min due to abnormal patterns/diaries; 350-511 concert to nighttime sleep
hist(wide_d14_outliers$`Education-Based Sedentary Behaviour at 14`)
wide_d14_outliers[wide_d14_outliers$`Education-Based Sedentary Behaviour at 14` > 600,]
#Education looks OK, longer instances are after school classes, homework, and reading
hist(wide_d14_outliers$`Leisure Time Sedentary Behaviour at 14`)
wide_d14_outliers[wide_d14_outliers$`Leisure Time Sedentary Behaviour at 14` > 700,]
#Exclude >700 because diary incomplete
wide_d14_outliers[((wide_d14_outliers$`Education-Based Sedentary Behaviour at 14` > 600) & (wide_d14_outliers$`Education-Based Sedentary Behaviour at 14` <= 700)),]
#Looks OK
hist(wide_d14_outliers$`Passive Transportation at 14`)
wide_d14_outliers[wide_d14_outliers$`Passive Transportation at 14` >= 300,]
#>340 traveling
hist(wide_d14_outliers$`Recreational Screen Time at 14`)
wide_d14_outliers[wide_d14_outliers$`Recreational Screen Time at 14` > 1000,]
#Exclude >1000 because all participants did not go to school that day 
hist(wide_d14_outliers$`Self Care Sedentary Behaviour at 14`)
wide_d14_outliers[wide_d14_outliers$`Self Care Sedentary Behaviour at 14` >= 90,]
hist(wide_d14_outliers$`Social-Based Sedentary Behaviour at 14`)
wide_d14_outliers[wide_d14_outliers$`Social-Based Sedentary Behaviour at 14` >= 800,]
#>800 same activity repeated in succession without other activities
wide_d14_outliers[((wide_d14_outliers$`Social-Based Sedentary Behaviour at 14` > 700) & (wide_d14_outliers$`Social-Based Sedentary Behaviour at 14` <= 800)),]
#>750 same as >800
hist(wide_d14_outliers$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 14`)
wide_d14_outliers[wide_d14_outliers$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 14` > 350,]
#All playing team sports - they appear to be at competition weekends or camps, exclude because although they may be typical weekends it is reasonable to think that the participants were resting/waiting for long periods during their MVPA; therefore, these numbers are probably not accurate in terms of movement
hist(wide_d14_outliers$`Unstructured Leisure Time Light-Intensity Physical Activity at 14`)
wide_d14_outliers[wide_d14_outliers$`Unstructured Leisure Time Light-Intensity Physical Activity at 14` >= 660,]
#Nobody in this category
wide_d14_outliers[wide_d14_outliers$`Unstructured Leisure Time Light-Intensity Physical Activity at 14` >= 300,]
#Plenty of particpants in this category and they look like reasonable days
wide_d14_outliers[wide_d14_outliers$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 14` > 350,]
#Aligned with structured MVPA
hist(wide_d14_outliers$`Work and Household Light-Intensity Physical Activity at 14`)
wide_d14_outliers[wide_d14_outliers$`Work and Household Light-Intensity Physical Activity at 14`> 800,]
#Nobody in this category
wide_d14_outliers[wide_d14_outliers$`Work and Household Light-Intensity Physical Activity at 14`> 400,]
#Reasonable looking
hist(wide_d14_outliers$`Nighttime Sleep at 14`)
wide_d14_outliers[wide_d14_outliers$`Nighttime Sleep at 14` >= 1000,]
#Didn't go to school


#Remove Wave 8 outliers
wide_d14_outliers <- wide_d14_outliers[!(wide_d14_outliers$`Active Transportation at 14` >= 300),]
#Removed 2 Wave 8 TUD
wide_d14_outliers <- wide_d14_outliers[!(wide_d14_outliers$`Daytime Naps at 14` >= 700),]
#Removed 1 Wave 8 TUD
wide_d14_outliers <- wide_d14_outliers[!(wide_d14_outliers$`Leisure Time Sedentary Behaviour at 14` >= 700),]
#Removed 1 Wave 8 TUD
wide_d14_outliers <- wide_d14_outliers[!(wide_d14_outliers$`Passive Transportation at 14` > 340),]
#Removed 25 Wave 8 TUD
wide_d14_outliers <- wide_d14_outliers[!(wide_d14_outliers$`Recreational Screen Time at 14` > 1000),]
#Removed 4 Wave 8 TUD
wide_d14_outliers <- wide_d14_outliers[!(wide_d14_outliers$`Self Care Sedentary Behaviour at 14` >= 90),]
#Removed 36 Wave 8 TUD
wide_d14_outliers <- wide_d14_outliers[!(wide_d14_outliers$`Social-Based Sedentary Behaviour at 14` > 750),]
#Removed 3 Wave 8 TUD
wide_d14_outliers <- wide_d14_outliers[!(wide_d14_outliers$`Structured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 14` >= 350),]
#Removed 9 Wave 8 TUD
wide_d14_outliers <- wide_d14_outliers[!(wide_d14_outliers$`Unstructured Leisure Time Moderate- to Vigorous- Intensity Physical Activity at 14` >= 350),]
#Removed 3 Wave 8 TUD
wide_d14_outliers <- wide_d14_outliers[!(wide_d14_outliers$`Nighttime Sleep at 14` > 1000),]
#Removed 1 Wave 8 TUD
```


```{r include=FALSE}
#Impute missing subject characteristics data 
#Look for missing participant data for SEP
relevant_lsacgrb10[is.na(relevant_lsacgrb10$SEP),]
#Do not include these participants in analysis since we do not want to impute SEP since it is a key predictor of the research question; additionally participants missing SEP data is < 5% (57/3,764)
#To do this, first combine with TUD dataset
#Combine the 3 time-use diaries 
merge(clean_names(wide_d10), clean_names(wide_d12), by ="hicid", all = T) -> completed_wide_d10_d12_merge
merged_TUD <- merge(completed_wide_d10_d12_merge, clean_names(wide_d14), by = "hicid", all =T)
merged_TUD <- merge(merged_TUD, relevant_lsacgrb10, by = "hicid", all =T)
merged_TUD[is.na(merged_TUD$SEP), ]


#Some participants didn't have TUD data at Wave 6, since this is our baseline, they will not be included in the analysis 
merged_TUD[is.na(merged_TUD$awake_time_at_10), ]

merged_TUD <- merged_TUD[!is.na(merged_TUD$awake_time_at_10),]
merged_TUD <- merged_TUD[!is.na(merged_TUD$SEP),]
#find out how many participants were missing TUD at Wave 7 and 8 
merged_TUD[is.na(merged_TUD$awake_time_at_12), ]
#632 participants missing Wave 7 TUD
merged_TUD[is.na(merged_TUD$awake_time_at_14), ]
#902 participants missing Wave 8 TUD
#Now, see how many participants are missing both TUD
merged_TUD[is.na(merged_TUD$awake_time_at_12) & is.na(merged_TUD$awake_time_at_14), ]
#432 participants missing TUD at Wave 7 and 8 
#Turn -9 into NA so it can be coded by Taren later
relevant_lsacgrb10$Remoteness[relevant_lsacgrb10$Remoteness == -9] <- NA

merged_TUD$day.x <- as.numeric(merged_TUD$day.x)
merged_TUD$day <- as.numeric(merged_TUD$day)
merged_TUD$day.y <- as.numeric(merged_TUD$day.y)
merged_TUD$Sex <- as.numeric(merged_TUD$Sex)
merged_TUD$Indigenous <- as.numeric(merged_TUD$Indigenous)
merged_TUD$Remoteness <- as.numeric(merged_TUD$Remoteness)
merged_TUD$school.x <- as.numeric(merged_TUD$school.x)
merged_TUD$school <- as.numeric(merged_TUD$school)
merged_TUD$school.y <- as.numeric(merged_TUD$school.y)
str(merged_TUD)
 
#Impute missing data using mice; excluded participant ID, awake time, sleep time, and total movement behaviours from model  
ini <- mice(merged_TUD, maxit=0)
pred <- ini$pred
pred[, c("hicid", "awake_time_at_10", "awake_time_at_12", "awake_time_at_14", "sleep_time_at_10", "sleep_time_at_12", "sleep_time_at_14", "total_general_movement_behaviours", "total_general_movement_behaviours.x", "total_general_movement_behaviours.y", "total_domain_specific_movement_behaviours", "total_domain_specific_movement_behaviours.x", "total_domain_specific_movement_behaviours.y", "school", "school.x", "school.y")] <- 0
meth <- ini$meth
meth["Sex"] <- "logreg"
meth["Indigenous"] <- "logreg"
meth["Remoteness"] <- "polr"
meth["day"] <- "polr" 
meth["day.x"] <- "polr"
meth["day.y"] <- "polr"
meth
mice(merged_TUD, method = "cart", pred=pred) -> imputed_merged_TUD
#Save imputed dataset
completed_merged_TUD <- complete(imputed_merged_TUD, 1)
colnames(completed_merged_TUD)[colnames(completed_merged_TUD) == "day.x"] <- "day_of_week_at_10"
colnames(completed_merged_TUD)[colnames(completed_merged_TUD) == "day.y"] <- "day_of_week_at_12"
colnames(completed_merged_TUD)[colnames(completed_merged_TUD) == "day"] <- "day_of_week_at_14"
colnames(completed_merged_TUD)[colnames(completed_merged_TUD) == "school.x"] <- "school_attendance_at_10"
colnames(completed_merged_TUD)[colnames(completed_merged_TUD) == "school.y"] <- "school_attendance_at_12"
colnames(completed_merged_TUD)[colnames(completed_merged_TUD) == "school"] <- "school_attendance_at_14"
completed_merged_TUD$day_of_week_at_10[!((completed_merged_TUD$day_of_week_at_10 == 6) | (completed_merged_TUD$day_of_week_at_10 == 7))] <- 1
completed_merged_TUD$day_of_week_at_10[(completed_merged_TUD$day_of_week_at_10 == 6) | (completed_merged_TUD$day_of_week_at_10 == 7)] <- 2
#Normalize data; first select relevant columns 
completed_merged_TUD %>% 
  select(6:14, 16:23, 30:38, 40:47, 54:62, 64:71) -> TUD_for_scaling
TUD_standardize <- as.data.frame(scale(TUD_for_scaling))
names(TUD_standardize) <- gsub("_at_", "_scaled_", names(TUD_standardize))
#Add scaled data to original data 
TUD_and_normalized_data <- cbind(completed_merged_TUD, TUD_standardize)
TUD_and_normalized_data[nrow(sapply(TUD_and_normalized_data, max)) + 1, ] -> normalized_TUD_min_and_max

```

```{r}
#Impute missing subject characteristics data 
#Look for missing participant data for SEP
relevant_lsacgrb10[is.na(relevant_lsacgrb10$SEP),]
#Do not include these participants in analysis since we do not want to impute SEP since it is a key predictor of the research question; additionally participants missing SEP data is < 5% (57/3,764)
#To do this, first combine with TUD dataset
#Combine the 3 time-use diaries 
merge(clean_names(wide_d10_outliers), clean_names(wide_d12_outliers), by ="hicid", all = T) -> completed_wide_d10_d12_removed_outliers
merged_TUD_removed_outliers <- merge(completed_wide_d10_d12_removed_outliers, clean_names(wide_d14_outliers), by = "hicid", all =T)
merged_TUD_removed_outliers <- merge(merged_TUD_removed_outliers, relevant_lsacgrb10, by = "hicid", all =T)
merged_TUD_removed_outliers[is.na(merged_TUD_removed_outliers$SEP), ]


#Some participants didn't have TUD data at Wave 6, since this is our baseline, they will not be included in the analysis 
merged_TUD_removed_outliers[is.na(merged_TUD_removed_outliers$awake_time_at_10), ]

merged_TUD_removed_outliers <- merged_TUD_removed_outliers[!is.na(merged_TUD_removed_outliers$awake_time_at_10),]
merged_TUD_removed_outliers <- merged_TUD_removed_outliers[!is.na(merged_TUD_removed_outliers$SEP),]
#find out how many participants were missing TUD at Wave 7 and 8 
merged_TUD_removed_outliers[is.na(merged_TUD_removed_outliers$awake_time_at_12), ]
#632 participants missing Wave 7 TUD
merged_TUD_removed_outliers[is.na(merged_TUD_removed_outliers$awake_time_at_14), ]
#902 participants missing Wave 8 TUD
#Now, see how many participants are missing both TUD
merged_TUD_removed_outliers[is.na(merged_TUD_removed_outliers$awake_time_at_12) & is.na(merged_TUD_removed_outliers$awake_time_at_14), ]
#432 participants missing TUD at Wave 7 and 8 
#Turn -9 into NA so it can be coded by Taren later
relevant_lsacgrb10$Remoteness[relevant_lsacgrb10$Remoteness == -9] <- NA

merged_TUD_removed_outliers$day.x <- as.numeric(merged_TUD_removed_outliers$day.x)
merged_TUD_removed_outliers$day <- as.numeric(merged_TUD_removed_outliers$day)
merged_TUD_removed_outliers$day.y <- as.numeric(merged_TUD_removed_outliers$day.y)
merged_TUD_removed_outliers$Sex <- as.numeric(merged_TUD_removed_outliers$Sex)
merged_TUD_removed_outliers$Indigenous <- as.numeric(merged_TUD_removed_outliers$Indigenous)
merged_TUD_removed_outliers$Remoteness <- as.numeric(merged_TUD_removed_outliers$Remoteness)
merged_TUD_removed_outliers$school.x <- as.numeric(merged_TUD_removed_outliers$school.x)
merged_TUD_removed_outliers$school <- as.numeric(merged_TUD_removed_outliers$school)
merged_TUD_removed_outliers$school.y <- as.numeric(merged_TUD_removed_outliers$school.y)
str(merged_TUD_removed_outliers)
 
#Impute missing data using mice; excluded participant ID, awake time, sleep time, and total movement behaviours from model  
ini <- mice(merged_TUD_removed_outliers, maxit=0)
pred <- ini$pred
pred[, c("hicid", "awake_time_at_10", "awake_time_at_12", "awake_time_at_14", "sleep_time_at_10", "sleep_time_at_12", "sleep_time_at_14", "total_general_movement_behaviours", "total_general_movement_behaviours.x", "total_general_movement_behaviours.y", "total_domain_specific_movement_behaviours", "total_domain_specific_movement_behaviours.x", "total_domain_specific_movement_behaviours.y", "school", "school.x", "school.y")] <- 0
meth <- ini$meth
meth["Sex"] <- "logreg"
meth["Indigenous"] <- "logreg"
meth["Remoteness"] <- "polr"
meth["day"] <- "polr" 
meth["day.x"] <- "polr"
meth["day.y"] <- "polr"
meth
mice(merged_TUD_removed_outliers, method = "cart", pred=pred) -> imputed_removed_outliers
#Save imputed dataset
completed_TUD_removed_outliers <- complete(imputed_removed_outliers, 1)
colnames(completed_TUD_removed_outliers)[colnames(completed_TUD_removed_outliers) == "day.x"] <- "day_of_week_at_10"
colnames(completed_TUD_removed_outliers)[colnames(completed_TUD_removed_outliers) == "day.y"] <- "day_of_week_at_12"
colnames(completed_TUD_removed_outliers)[colnames(completed_TUD_removed_outliers) == "day"] <- "day_of_week_at_14"
colnames(completed_TUD_removed_outliers)[colnames(completed_TUD_removed_outliers) == "school.x"] <- "school_attendance_at_10"
colnames(completed_TUD_removed_outliers)[colnames(completed_TUD_removed_outliers) == "school.y"] <- "school_attendance_at_12"
colnames(completed_TUD_removed_outliers)[colnames(completed_TUD_removed_outliers) == "school"] <- "school_attendance_at_14"
completed_TUD_removed_outliers$day_of_week_at_10[!((completed_TUD_removed_outliers$day_of_week_at_10 == 6) | (completed_TUD_removed_outliers$day_of_week_at_10 == 7))] <- 1
completed_TUD_removed_outliers$day_of_week_at_10[(completed_TUD_removed_outliers$day_of_week_at_10 == 6) | (completed_TUD_removed_outliers$day_of_week_at_10 == 7)] <- 2
#Normalize data; first select relevant columns 
completed_TUD_removed_outliers %>% 
  select(6:14, 16:23, 30:38, 40:47, 54:62, 64:73) -> TUD_for_scaling_outliers
TUD_standardize_no_outliers <- as.data.frame(scale(TUD_for_scaling_outliers))
names(TUD_standardize_no_outliers) <- gsub("_at_", "_scaled_", names(TUD_standardize_no_outliers))
#Add scaled data to original data 
TUD_and_removed_outliers_normalized <- cbind(completed_TUD_removed_outliers, TUD_standardize_no_outliers)

```


```{r eval=FALSE, include=FALSE}
TUD_and_normalized_data %>% 
  select(1, 4:14, 16:23, 28:38, 40:47, 52:62, 64:71, 74:129) -> Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours
colnames(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours)[colnames(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) == "education_based_sedentary_behaviour_at_10"] <- "education_SB_at_10"
names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("sedentary_behaviour", "SB", names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("moderate_to_vigorous_intensity_physical_activity", "MVPA", names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("light_intensity_physical_activity", "LPA", names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("_leisure_time_", "_", names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("transportation", "transport", names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("recreational_", "", names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("work_and_", "", names(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
write_dta(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours, "Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours.dta")
save(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours, file ='Z:/LSAC dataset/Study_2/Study_2/Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours.RData')

foreign::write.dta(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours, "Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours.dta")
save(Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours, file = 'Z:/LSAC dataset/Study_2/Study_2/Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours.dta')

```

```{r}
TUD_and_removed_outliers_normalized %>% 
  select(1, 4:14, 16:23, 28:38, 40:47, 52:62, 64:71, 74:129) -> No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours
colnames(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours)[colnames(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) == "education_based_sedentary_behaviour_at_10"] <- "education_SB_at_10"
names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("sedentary_behaviour", "SB", names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("moderate_to_vigorous_intensity_physical_activity", "MVPA", names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("light_intensity_physical_activity", "LPA", names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("_leisure_time_", "_", names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("transportation", "transport", names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("recreational_", "", names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours) <- gsub("work_and_", "", names(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours))
write_dta(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours, "No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours.dta")
save(No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours, file ='Z:/LSAC dataset/Study_2/Study_2/No_outliers_Multi_Trajecotry_Analysis_Domain_Specific_Movement_Behaviours.RData')
```



```{r echo=FALSE}
##Imputed missing data
#Here: Checked that imputed variables are plausible 
densityplot(imputed_merged_TUD)
#Imputed values look reasonable! Woo hoooooo!!!!
```

```{r eval=FALSE, include=FALSE}
skimr::skim(completed_merged_TUD %>% as_tibble() %>% mutate(Remoteness=as_factor(Remoteness)) %>% mutate(day_of_week_at_10=as_factor(day_of_week_at_10)) %>%  mutate(day_of_week_at_12=as_factor(day_of_week_at_12)) %>% mutate(day_of_week_at_14=as_factor(day_of_week_at_14)) %>% select(-hicid, -starts_with("awake_"), -starts_with("sleep_time"), -starts_with("total_"), -starts_with("uncodeable_"), -starts_with("day_"), -starts_with("school"))) -> relevant_descriptive_data
relevant_descriptive_data$category <- c(1,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,1,1,1,1)
relevant_descriptive_data$numeric.mean <- round(relevant_descriptive_data$numeric.mean, digits = 0)
relevant_descriptive_data$numeric.sd <- round(relevant_descriptive_data$numeric.sd, digits = 0)
relevant_descriptive_data$numeric.sd <- paste0("(", relevant_descriptive_data$numeric.sd, ")")
relevant_descriptive_data$"Mean (SD) or %" <- paste(relevant_descriptive_data$numeric.mean, relevant_descriptive_data$numeric.sd, sep = " ")
relevant_descriptive_data$skim_variable <- str_replace_all(relevant_descriptive_data$skim_variable, "_", " ")
relevant_descriptive_data$skim_variable <- str_to_title(relevant_descriptive_data$skim_variable)
relevant_descriptive_data$skim_variable <- str_replace_all(relevant_descriptive_data$skim_variable, c("At"="at", "To" = "to", "Light Intensity"= "Light-Intensity", "Moderate" = "Moderate-", "Vigorous" = "Vigorous-"))
colnames(relevant_descriptive_data)[colnames(relevant_descriptive_data) == "skim_variable"] <- "Characteristics"


```

```{r echo=FALSE}
#Make Descriptive Statistics Table
#install.packages("table1")
library("table1")
#Select relevant columns for the descriptive statistics table
completed_merged_TUD %>% 
  select(-c(hicid, awake_time_at_10, awake_time_at_12, awake_time_at_14, sleep_time_at_10, sleep_time_at_12, sleep_time_at_14, day_of_week_at_10, day_of_week_at_12, day_of_week_at_14, school_attendance_at_10, school_attendance_at_12, school_attendance_at_14, uncodeable_activity_at_10, uncodeable_activity_at_12, uncodeable_activity_at_14, total_domain_specific_movement_behaviours, total_domain_specific_movement_behaviours.x, total_domain_specific_movement_behaviours.y, total_general_movement_behaviours, total_general_movement_behaviours.x, total_general_movement_behaviours.y)) -> completed_merged_TUD2
#Arrange the columns in the appropriate order
completed_merged_TUD2 %>% 
  select(order(colnames(completed_merged_TUD2))) %>% 
  relocate(c(Age, Indigenous, Remoteness, Sex, SEP), .before = active_transportation_at_10) %>% 
  relocate(light_intensity_physical_activity_at_10:moderate_to_vigorous_intensity_physical_activity_at_14, .after = work_and_household_light_intensity_physical_activity_at_14) %>% 
  relocate(c(sedentary_behaviour_at_10:sedentary_behaviour_at_14, sleep_at_10:sleep_at_14), .after = moderate_to_vigorous_intensity_physical_activity_at_14) -> descriptive_statistics 
descriptive_statistics <- data.frame(append(descriptive_statistics, list("Subject_Details" = "", "Domain_Specific_Movement_Behaviours" = "", "General_Movement_Behaviours" = ""), after = 1))
descriptive_statistics %>% 
 relocate("Subject_Details", .before = Age) %>% 
  relocate("Domain_Specific_Movement_Behaviours", .before = active_transportation_at_10) %>% 
  relocate("General_Movement_Behaviours", .before = light_intensity_physical_activity_at_10) -> descriptive_statistics
#Clean column names
colnames(descriptive_statistics) <- gsub("_", " ", colnames(descriptive_statistics))
colnames(descriptive_statistics) <- str_to_title(colnames(descriptive_statistics))
colnames(descriptive_statistics) <- gsub("At", "at", colnames(descriptive_statistics))
colnames(descriptive_statistics) <- gsub("To", "to", colnames(descriptive_statistics))
colnames(descriptive_statistics) <- gsub("Light I", "Light-I", colnames(descriptive_statistics))
colnames(descriptive_statistics) <- gsub("Moderate", "Moderate-", colnames(descriptive_statistics))
colnames(descriptive_statistics) <- gsub("Vigorous", "Vigorous-", colnames(descriptive_statistics))
rename(descriptive_statistics, "Socioeconomic Position" = Sep) -> descriptive_statistics


#Define factor variables
descriptive_statistics$Indigenous <-
  factor(descriptive_statistics$Indigenous, levels = c(1, 2, 3, 4),
         labels = c("Not Aboriginal", "Aboriginal", "Torres Strait Islander", "Both"))
descriptive_statistics$Sex <-
  factor(descriptive_statistics$Sex, levels = c(1, 2),
         labels = c("Male", "Female"))
descriptive_statistics$Remoteness <-
  factor(descriptive_statistics$Remoteness, levels = c(0, 1, 2, 3, 4, 9),
         labels = c("Highly Accessible", "Accessible", "Moderately Accessible", "Remote", "Very Remote", "Not determined")) 
#Write rendering function for Mean and counts
my.render.cont <- function(x) {
    with(stats.apply.rounding(stats.default(x), digits=2), c("",
        "Mean (SD)"=sprintf("%s (&plusmn; %s)", MEAN, SD)))
}
my.render.cat <- function(x) {
    c("", sapply(stats.default(x), function(y) with(y,
        sprintf("%d (%0.0f %%)", FREQ, PCT))))
}
#Create table
#colorize <- function(x, color) {
 # if (knitr::is_html_output()) {
 ##   sprintf("<span style='color: %s;'>%s</span>", color,
  #    x)
 # }}
table1(~ ., data = descriptive_statistics, overall = "Mean (SD) or Count (%)", footnote = "Age is measured in year; Socioeconomic Position is a composite score of income, educational attainment, and occupation status; Movement Behaviours are measured in minutes", caption = "Table 1. Descriptive Statistics.", render.continuous=my.render.cont, render.categorical=my.render.cat)
#table1(~ ., data = descriptive_statistics, overall = "Mean (SD) or Count (%)", render.continuous=my.render.cont, render.categorical=my.render.cat) -> Table1_Stats
#'r colorize(Table1_Stats, "black")'

```


```{r eval=FALSE, include=FALSE}
#Calculate means and SD for MB at all timepoints and subject details 
#Turn off scientific notation 
options(scipen = 999)
#Create new dataframe with mean and SD calculations of MB
completed_merged_TUD %>% 
  select()
first_column <- c(colMeans(completed_merged_TUD[, c(4:65)]) %>% 
  round(digits = 0))
second_column <- c(sapply(completed_merged_TUD[,c(4:65)], sd) %>% 
  round(digits=0))
MB_stats <- data.frame(first_column, second_column)
#Add parentheses to SD
MB_stats$second_column <- paste0("(", MB_stats$second_column, ")")
#Combine means and SD in the same column
MB_stats$"Mean (SD) or %" <- paste(MB_stats$first_column, MB_stats$second_column, sep = " ")
#Remove columns with just the mean or SD
MB_stats %>% select(-(first_column:second_column)) -> MB_stats
#Make the label column an actual column
MB_stats$Characteristics <- rownames(MB_stats)
#Get rid of the label column
rownames(MB_stats) <- c()
#Swap the column positions
MB_stats <- MB_stats %>% 
  relocate(Characteristics, .before = `Mean (SD) or %`)
#Delete the unnecessary rows that I accidentally included
MB_stats[-c(10, 19, 20, 21, 22, 32, 41, 42, 43, 44, 54),] -> MB_stats

#First, calculate percentage of males vs. females, Indigenous, and mean/SD for age, remoteness, and SEP
completed_merged_TUD %>% 
    group_by(Sex) %>% 
    summarise(percent = 100 * n() /nrow(completed_merged_TUD)) 

completed_merged_TUD %>% 
    group_by(Indigenous) %>% 
    summarise(percent = 100 * n() /nrow(completed_merged_TUD))

mean(completed_merged_TUD$Age)
sd(completed_merged_TUD$Age)
mean(completed_merged_TUD$Remoteness)
sd(completed_merged_TUD$Remoteness)
mean(completed_merged_TUD$SEP)
sd(completed_merged_TUD$SEP)
#Create dataframe containing subject stats
subject_stats <- data.frame(x = c('Age (Years)', 'Female (% yes)', 'Indigenous (% yes)', 'Remoteness', 'Socioeconomic Position'),
                            y = c('10.4 (.49)', 49.1, 2.6, '.77 (1.25)', '.02 (1.00)'))
#Rename columns
setNames(subject_stats, c("Characteristics", "Mean (SD) or %")) -> subject_stats

#Combine datasets
descriptive_stats <- rbind(subject_stats, MB_stats)
#Assign "categories' for subject details, domain-specific movement behaviours, and general movement behaviours
descriptive_stats$category <- c(1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2,2)
arrange(descriptive_stats, category, Characteristics) -> descriptive_stats
descriptive_stats %>% select(-category) -> descriptive_stats 
rownames(descriptive_stats) <- c() 
descriptive_stats$Characteristics <- str_replace_all(descriptive_stats$Characteristics, "_", " ")
descriptive_stats$Characteristics <- str_to_title(descriptive_stats$Characteristics)

kbl(descriptive_stats, caption = "Table 1. Descriptive Statistics.") %>% 
  kable_paper(full_width = F) %>% 
  pack_rows("Subject Details", 1, 5) %>% 
  pack_rows("General Movement Behaviours", 6, 17) %>% 
  pack_rows("Domain-Specific Movement Behaviours", 18, 56) %>% 
  footnote(general = "Remoteness: based on neighbourhood status remoteness area classification, 0 Highly accessible, 1 Accessible, 2 Moderately Accessible, 3 Remote, 4 Very remote; Socioeconomic Position: a compositive score consisiting of parents' income, education, and occupational status; all movement behaviour means and standard deviations are measured in minutes; 10, 12, and 14 refer to the participants' age at the time of data collection")                                 
                                  


```



```{r echo=FALSE}
#Test to see if there are differences between the included and excluded participants' sex, Indigenous status, and remoteness 
#install.packages("rstatix")
#Find the excluded participants 
setdiff(relevant_lsacgrb10$hicid, merged_TUD$hicid) -> excludedlist
relevant_lsacgrb10$excluded <- relevant_lsacgrb10$hicid %in% excludedlist
mean(relevant_lsacgrb10$Remoteness[relevant_lsacgrb10$excluded == TRUE]) -> mean_excluded_remoteness
sd(relevant_lsacgrb10$Remoteness[relevant_lsacgrb10$excluded == TRUE]) -> sd_excluded_remoteness   
mean(relevant_lsacgrb10$Age[relevant_lsacgrb10$excluded == TRUE]) -> mean_excluded_age
sd(relevant_lsacgrb10$Age[relevant_lsacgrb10$excluded == TRUE]) -> sd_excluded_age
mean(relevant_lsacgrb10$SEP[relevant_lsacgrb10$excluded == TRUE]) -> mean_excluded_SEP
sd(relevant_lsacgrb10$SEP[relevant_lsacgrb10$excluded == TRUE]) -> sd_excluded_SEP
relevant_lsacgrb10 %>% 
  filter(excluded == TRUE) %>% 
    group_by(Sex) %>% 
    summarise(percent = 100 * n() / length(excludedlist)) 

relevant_lsacgrb10 %>% 
   filter(excluded == TRUE) %>% 
    group_by(Indigenous) %>% 
    summarise(percent = 100 * n() / length(excludedlist))

library("rstatix")
relevant_lsacgrb10 %>% 
  t_test(Remoteness ~ excluded, detailed = TRUE) %>% 
  add_significance()
#Groups were not significantly different 
#Find difference between proportions of girls and boys in included and excluded group; 1= male, TRUE = excluded
table(relevant_lsacgrb10$Sex, relevant_lsacgrb10$excluded)
chisq.test(table(relevant_lsacgrb10$Sex, relevant_lsacgrb10$excluded))
#Groups were not significantly different
#Make column saying if Indigenous or not; TRUE = not indigenous
relevant_lsacgrb10$Yes_No_Indigenous <-relevant_lsacgrb10$Indigenous == 1 
#Find difference between proportions of Indigenous participants included in the analysis; FALSE = Indigenous (y), TRUE = excluded (x)
#Groups were not statistically significant
table(relevant_lsacgrb10$Yes_No_Indigenous, relevant_lsacgrb10$excluded)
chisq.test(table(relevant_lsacgrb10$Yes_No_Indigenous, relevant_lsacgrb10$excluded))
```

```{r echo=FALSE}
#Test correlations between movement behaviours
#install.packages("corrr")
library("corrr")
completed_merged_TUD %>% 
  select(active_transportation_at_10:structured_leisure_time_moderate_to_vigorous_intensity_physical_activity_at_10, unstructured_leisure_time_light_intensity_physical_activity_at_10:sleep_at_10, active_transportation_at_12:structured_leisure_time_moderate_to_vigorous_intensity_physical_activity_at_12, unstructured_leisure_time_light_intensity_physical_activity_at_12:sleep_at_12, active_transportation_at_14:structured_leisure_time_moderate_to_vigorous_intensity_physical_activity_at_14, unstructured_leisure_time_light_intensity_physical_activity_at_14:sleep_at_14, SEP) -> correlation_variables

#Rename variables so the chart is readable
rename_with(correlation_variables, ~1:52) -> renamed_correlation_variables
#Naturally, overall sleep and nighttime sleep are high correlated! I forgot to split up the general and domaini-specific movement behaviours. Whoops! 
correlation_variables %>% 
  select(light_intensity_physical_activity_at_10:sleep_at_10, light_intensity_physical_activity_at_12:sleep_at_12, light_intensity_physical_activity_at_14:sleep_at_14) -> general_MB_correlation_variables
#Rename general movement behaviours so the chart is readable
rename_with(general_MB_correlation_variables, ~1:12) -> renamed_general_MB_correlation_variables
#Plot correlations
corrplot::corrplot(cor(renamed_general_MB_correlation_variables))
#All good here, now do the same thing with domain-specific movement behaviours
correlation_variables %>% 
  select(active_transportation_at_10:nighttime_sleep_at_10, active_transportation_at_12:nighttime_sleep_at_12, active_transportation_at_14:nighttime_sleep_at_14) -> domain_specific_MB_correlation_variables

rename_with(domain_specific_MB_correlation_variables, ~1:39) -> renamed_domain_specific_MB_correlation_variables

corrplot::corrplot(cor(renamed_domain_specific_MB_correlation_variables))
#Happy correlations, all good! 
#install.packages("corrplot")


#apply(correlation_variables,2,function(col)cor.test(col, correlation_variables$SEP)) -> SEP_correlation_tests

```

```{r}
#Creat a flow diagram of participants that met eligibility criteria 
knitr::include_graphics("Figure1SubjectFlowChart.jpg")
```

```{r}
install.packages("devtools")  ## do not run if package 'devtools' is already installed
library(devtools)
install_github("alessandromagrini/gbmt")

data(agrisus2)
??agrisus2          ## data description
summary(agrisus2)  ## data summaries

varNames <- c("TFP_2005_CAP","NetCapital_GVA","Manager_ratio",
  "FactorIncome_paid_2010","EntrIncome_unpaid_2010",
  "Income_rur","Unempl_rur","Poverty_rur",
  "RenewProd","Organic_p","GHG_UAA","GNB_UAA")

m4_3 <- gbmt(x.names=varNames, unit="Country", time="Year", d=3, ng=4 ,data=agrisus2)

m4_3$assign.list

m4_3$fitted

plot(m4_3, group=1)  ## group 1
plot(m4_3, group=2)  ## group 2
plot(m4_3, group=3)  ## group 3
plot(m4_3, group=4)  ## group 4

predict(m4_3, n.ahead=3)  ## 3-step ahead

m4_3r <- gbmt(x.names=varNames, unit="Country", time="Year", d=3, ng=4, data=agrisus2, nstart=100)

ng <- 1:6
modList <- vector("list", length=length(ng))
names(modList) <- ng
for(i in 1:length(ng)) {
  set.seed(123)  ## seed for reproducibility
  modList[[i]] <- gbmt(x.names=varNames, unit="Country", time="Year", d=3, ng=ng[i],
                      data=agrisus2, nstart=100)
  }
do.call(rbind, lapply(modList, function(x){x$ic}))

ng <- 1:6
modListFull <- vector("list", length=length(ng))
names(modListFull) <- ng
for(i in 1:length(ng)) {
  set.seed(123)  ## seed for reproducibility
  modListFull[[i]] <- gbmt(x.names=varNames, unit="Country", time="Year", d=3, ng=ng[i],
                           data=agrisus, tol=1e-4, maxit=5000, nstart=100)
  }
do.call(rbind, lapply(modListFull, function(x){x$ic}))

```

